"use strict";const e=require("../../../../common/vendor.js"),t=require("../../../../utils/common.js"),s=require("../../api/coupon.js"),o=require("../../../../components/mescroll/hooks/useMescroll.js"),l=require("../../../../stores/member.js"),r=require("../../../../hooks/useLogin.js");require("../../../../locale/i18n.js"),require("../../../../stores/system.js"),require("../../../../utils/pages.js"),require("../../../../app/stores/diy.js"),require("../../../../stores/config.js"),require("../../../../app/api/auth.js"),require("../../../../utils/request.js"),require("../../../../locale/index.js"),require("../../../../app/api/member.js"),require("../../../../locale/language.js"),require("../../../../app/api/system.js"),Math||(n+i)();const i=()=>"../../../../components/mescroll/mescroll-body/mescroll-body.js",n=()=>"../../../../components/mescroll/mescroll-empty/mescroll-empty.js",a=e.defineComponent({__name:"list",setup(i){const{mescrollInit:n,downCallback:a,getMescroll:u}=o.useMescroll(e.onPageScroll,e.onReachBottom),c=e.ref([]),p=e.ref(!0),m=l.useMemberStore(),d=e.computed((()=>m.info)),y=e=>{p.value=!0;let t={page:e.num,limit:e.size};s.getCouponList(t).then((t=>{let s=t.data.data.map((e=>(console.log("userInfo",d.value),e.lead_count==e.count&&(e.btnType="collected"),d.value&&e.is_receive&&e.max_fetch===e.member_receive_count?e.btnType="using":e.btnType="collecting",e)));1==e.num&&(c.value=[]),c.value=c.value.concat(s),e.endSuccess(s.length),p.value=!1})).catch((()=>{p.value=!1,e.endErr()}))};return(o,l)=>e.e({a:e.f(c.value,((o,l,i)=>e.e({a:"collected"===o.btnType},"collected"===o.btnType?e.e({b:e.t(o.money),c:"0.00"===o.atleast},"0.00"===o.atleast?{}:{d:e.t(o.atleast)},{e:e.t(o.name),f:0==o.validity_type},0==o.validity_type?{g:e.t(o.fixed_term||"")}:1==o.validity_type?{i:e.t(o.end_usetime?o.end_usetime.slice(0,10):"")}:{},{h:1==o.validity_type,j:l?1:""}):e.e({k:e.t(o.money),l:"0.00"===o.atleast},"0.00"===o.atleast?{}:{m:e.t(o.atleast)},{n:e.t(o.name),o:0==o.validity_type},0==o.validity_type?{p:e.t(o.fixed_term||"")}:1==o.validity_type?{r:e.t(o.end_usetime?o.end_usetime.slice(0,10):"")}:{},{q:1==o.validity_type,s:"collecting"===o.btnType},"collecting"===o.btnType?{t:e.o((e=>((e,t)=>{if(!d.value)return r.useLogin().setLoginBack({url:"/addon/zzhc/pages/coupon/list"}),!1;s.receiveCoupon({coupon_id:e,number:1,type:"receive"}).then((e=>{c.value[t].btnType="using"}))})(o.coupon_id,l)))}:{},{v:"using"===o.btnType},"using"===o.btnType?{w:e.o((e=>{t.redirect({url:"/addon/zzhc/pages/order/list"})}))}:{},{x:l?1:""})))),b:!c.value.length&&!p.value},c.value.length||p.value?{}:{c:e.p({option:{icon:e.unref(t.img)("static/resource/images/empty.png")}})},{d:e.sr("mescrollRef","fb853a6a-0"),e:e.o(e.unref(n)),f:e.o(e.unref(a)),g:e.o(y),h:e.s(o.themeColor())})}});a.__runtimeHooks=1,tt.createPage(a);
