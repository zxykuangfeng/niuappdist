"use strict";const e=require("../../../../common/vendor.js"),o=require("../../../../locale/index.js"),r=require("../../../../utils/common.js"),a=require("../../api/staff.js"),s=require("../../api/goods.js"),t=require("../../api/vip.js"),l=require("../../api/order.js"),i=require("../../../../components/mescroll/hooks/useMescroll.js"),u=require("../../utils/common.js"),n=require("../../../../stores/member.js");if(require("../../../../locale/i18n.js"),require("../../../../locale/language.js"),require("../../../../utils/pages.js"),require("../../../../stores/system.js"),require("../../../../app/api/system.js"),require("../../../../utils/request.js"),require("../../../../stores/config.js"),require("../../../../app/api/auth.js"),require("../../../../app/stores/diy.js"),require("../../../../hooks/useLogin.js"),require("../../../../app/api/member.js"),!Array){(e.resolveComponent("u-icon")+e.resolveComponent("u--image")+e.resolveComponent("u-tabbar"))()}Math||((()=>"../../../../node-modules/uview-plus/components/u-icon/u-icon.js")+(()=>"../../../../node-modules/uview-plus/components/u--image/u--image.js")+d+c+(()=>"../../../../node-modules/uview-plus/components/u-tabbar/u-tabbar.js"))();const c=()=>"../../../../components/mescroll/mescroll-body/mescroll-body.js",d=()=>"../../../../components/mescroll/mescroll-empty/mescroll-empty.js",m=e.defineComponent({__name:"select",setup(c){const{mescrollInit:d,downCallback:m,getMescroll:p}=i.useMescroll(e.onPageScroll,e.onReachBottom),v=e.ref([]),g=e.ref([]),f=e.ref([]),_=e.ref(0),h=e.ref(null),j=e.ref(0),q=e.ref([]),b=e.ref(!1),y=e.ref({}),x=e.ref(!1);e.onLoad((e=>{j.value=e.staff_id,w(),C(),M()})),e.onShow((()=>{0==u.currStoreId()&&r.redirect({url:"/addon/zzhc/pages/store/list",mode:"navigateTo"})}));const C=()=>{a.getBarberDetail(j.value).then((e=>{q.value=e.data}))},w=()=>{t.getVipConfig().then((e=>{y.value=e.data}))},M=()=>{s.getCategoryList().then((e=>{f.value=e.data}))},k=e=>{x.value=!1;let o={page:e.num,limit:e.size,category_id:_.value};s.getGoodsList(o).then((o=>{let r=o.data.data;1==e.num&&(v.value=[]),v.value=v.value.concat(r),e.endSuccess(r.length),x.value=!0})).catch((()=>{x.value=!0,e.endErr()}))},S=e=>{_.value=e,v.value=[],p().resetUpScroll()},z=()=>{if(""==n.useMemberStore().info.mobile)e.index.showModal({title:"温馨提示",content:"请先绑定手机号",confirmText:"去绑定",success(e){e.confirm&&r.redirect({url:"/app/pages/member/personal"})}});else{b.value=!0;let e={store_id:u.currStoreId(),staff_id:j.value,goods_id:g.value.goods_id};l.orderCreate(e).then((e=>{r.redirect({url:"/addon/zzhc/pages/order/detail",param:{order_id:e.data.order_id},mode:"redirectTo"})})).catch((()=>{b.value=!1}))}};return e.onMounted((()=>{setTimeout((()=>{p().optUp.textNoMore=o.t("end")}),500)})),(o,a)=>e.e({a:e.unref(r.img)(q.value.staff_headimg),b:e.t(q.value.staff_name),c:e.t(q.value.staff_position),d:e.n({"class-select":0==_.value}),e:e.o((e=>S(0))),f:e.f(f.value,((o,r,a)=>({a:e.t(o.category_name),b:e.n({"class-select":_.value==o.category_id}),c:e.o((e=>S(o.category_id))),d:r}))),g:e.f(v.value,((o,a,s)=>e.e({a:"5c44a0a1-2-"+s+",5c44a0a1-1-"+s,b:"5c44a0a1-1-"+s+",5c44a0a1-0",c:e.p({width:"175rpx",height:"175rpx",src:e.unref(r.img)(o.goods_image),model:"aspectFill"}),d:e.t(o.goods_name)},1==y.value.is_enable?{e:e.t(e.unref(r.moneyFormat)(o.price*(y.value.discount/10)))}:{},{f:e.t(o.price),g:e.t(o.duration),h:g.value.goods_id==o.goods_id},(g.value.goods_id,o.goods_id,{}),{i:a,j:e.o((e=>g.value=o))}))),h:e.p({name:"photo",color:"var(--primary-color-dark)",size:"50"}),i:1==y.value.is_enable,j:!v.value.length&&x.value},!v.value.length&&x.value?{k:e.p({option:{tip:"暂无项目"}})}:{},{l:e.sr(h,"5c44a0a1-0",{k:"mescrollRef"}),m:e.o(e.unref(d)),n:e.o(e.unref(m)),o:e.o(k),p:e.p({top:"300rpx"}),q:1==y.value.is_enable&&g.value.price},1==y.value.is_enable&&g.value.price?{r:e.t(e.unref(r.moneyFormat)(g.value.price*(y.value.discount/10)))}:{},{s:e.t(g.value.price?g.value.price:0),t:!g.value.goods_id,v:b.value,w:e.o(z),x:e.p({fixed:!0,placeholder:!0,safeAreaInsetBottom:!0}),y:e.s(o.themeColor())})}});m.__runtimeHooks=1,tt.createPage(m);
