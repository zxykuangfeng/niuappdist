"use strict";const e=require("../../../../common/vendor.js"),r=require("../../../../locale/index.js"),t=require("../../../../utils/common.js"),s=require("../../api/order.js"),o=require("../../../../components/mescroll/hooks/useMescroll.js"),a=require("../../utils/map/openMap.js"),n=require("../../utils/common.js");if(require("../../../../locale/i18n.js"),require("../../../../locale/language.js"),require("../../../../utils/pages.js"),require("../../../../stores/system.js"),require("../../../../app/api/system.js"),require("../../../../utils/request.js"),require("../../../../stores/member.js"),require("../../../../app/api/member.js"),require("../../../../app/api/auth.js"),require("../../../../stores/config.js"),require("../../../../app/stores/diy.js"),require("../../../../hooks/useLogin.js"),require("../../utils/map/transformCoordinate.js"),!Array){(e.resolveComponent("pay")+e.resolveComponent("tabbar"))()}Math||(l+u+(()=>"../../../../components/pay/pay.js")+(()=>"../../../../components/tabbar/tabbar.js"))();const u=()=>"../../../../components/mescroll/mescroll-body/mescroll-body.js",l=()=>"../../../../components/mescroll/mescroll-empty/mescroll-empty.js",i=e.defineComponent({__name:"list",setup(u){const{mescrollInit:l,downCallback:i,getMescroll:c}=o.useMescroll(e.onPageScroll,e.onReachBottom);let m=e.ref([]),d=e.ref(!1),p=e.ref(!1),f=e.ref(""),g=e.ref([]);e.onLoad((e=>{f.value=e.status||"",j()}));const h=e=>{d.value=!1;let r={page:e.num,limit:e.size,status:f.value};s.getOrderList(r).then((r=>{let t=r.data.data;1==e.num&&(m.value=[]),m.value=m.value.concat(t),e.endSuccess(t.length),d.value=!0})).catch((()=>{d.value=!0,e.endErr()}))},j=()=>{p.value=!1,g.value=[];g.value.push({name:"全部",status:""}),s.getOrderStatus().then((e=>{Object.values(e.data).forEach(((e,r)=>{g.value.push(e)})),p.value=!0})).catch((()=>{p.value=!0}))},v=e=>{t.redirect({url:"/addon/zzhc/pages/order/detail",param:{order_id:e.order_id}})},_=e.ref(null),q=r=>{e.index.showModal({title:"提示",content:"您确定要取消该订单吗？",success:e=>{e.confirm&&s.orderCancel(r.order_id).then((e=>{c().resetUpScroll()}))}})};return(s,o)=>e.e({a:e.unref(p)},e.unref(p)?{b:e.f(e.unref(g),((r,t,s)=>({a:e.t(r.name),b:e.n({"class-select":e.unref(f)===r.status.toString()}),c:e.o((e=>{return t=r.status,f.value=t.toString(),m.value=[],void c().resetUpScroll();var t}))}))),c:s.headerHeight}:{},{d:e.f(e.unref(m),((s,o,u)=>e.e({a:e.t(s.store.store_name),b:e.o((r=>e.unref(a.openMap).openMap(s.store.latitude,s.store.longitude,s.store.full_address))),c:e.o((r=>e.unref(n.callPhone)(s.store.store_mobile))),d:1==s.status},1==s.status?{e:e.t(s.wait_people),f:e.t(s.wait_duration),g:e.t(s.mobile.substr(s.mobile.length-4))}:{},{h:e.unref(t.img)(s.goods_image),i:e.t(s.goods_name),j:e.t(s.goods_vip_money),k:e.t(s.goods_money),l:e.unref(t.img)(s.staff_headimg),m:e.t(s.staff_name),n:e.o((e=>v(s))),o:e.t(s.create_time),p:e.t(s.status_name.name),q:1==s.status},1==s.status?{r:e.t(e.unref(r.t)("orderCancel")),s:e.o((e=>((e,r="")=>{var t;"pay"==r?null==(t=_.value)||t.open(e.order_type,e.order_id,`/addon/zzhc/pages/order/detail?order_id=${e.order_id}`):"cancel"==r&&q(e)})(s,"cancel")))}:{},{t:3!=s.status},3!=s.status?{v:e.t(e.unref(r.t)("orderDetail")),w:e.o((e=>v(s)))}:{},{x:3==s.status},3==s.status?{y:e.t(e.unref(r.t)("topay")),z:e.o((e=>v(s)))}:{},{A:o}))),e:e.unref(t.img)("/addon/zzhc/dh.png"),f:e.unref(t.img)("/addon/zzhc/phone.png"),g:!e.unref(m).length&&e.unref(d)},!e.unref(m).length&&e.unref(d)?{h:e.p({option:{icon:e.unref(t.img)("static/resource/images/empty.png")}})}:{},{i:e.sr("mescrollRef","2942618b-0"),j:e.o(e.unref(l)),k:e.o(e.unref(i)),l:e.o(h),m:e.p({top:"114rpx"}),n:e.sr(_,"2942618b-2",{k:"payRef"}),o:e.o(s.payClose),p:e.p({addon:"zzhc"}),q:e.s(s.themeColor())})}});i.__runtimeHooks=1,tt.createPage(i);
