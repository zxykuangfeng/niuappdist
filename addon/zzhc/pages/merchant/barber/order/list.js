"use strict";const e=require("../../../../../../common/vendor.js");require("../../../../../../locale/i18n.js"),require("../../../../../../stores/system.js");const r=require("../../../../../../utils/common.js"),t=require("../../../../api/order.js"),s=require("../../../../api/merchant.js"),o=require("../../../../../../components/mescroll/hooks/useMescroll.js"),a=require("../../../../utils/common.js");if(require("../../../../../../locale/language.js"),require("../../../../../../utils/pages.js"),require("../../../../../../app/api/system.js"),require("../../../../../../utils/request.js"),require("../../../../../../stores/member.js"),require("../../../../../../app/api/member.js"),require("../../../../../../app/api/auth.js"),require("../../../../../../stores/config.js"),require("../../../../../../app/stores/diy.js"),require("../../../../../../hooks/useLogin.js"),require("../../../../../../locale/index.js"),!Array){(e.resolveComponent("u-avatar")+e.resolveComponent("u-icon"))()}Math||((()=>"../../../../../../node-modules/uview-plus/components/u-avatar/u-avatar.js")+(()=>"../../../../../../node-modules/uview-plus/components/u-icon/u-icon.js")+i+n)();const n=()=>"../../../../../../components/mescroll/mescroll-body/mescroll-body.js",i=()=>"../../../../../../components/mescroll/mescroll-empty/mescroll-empty.js",u=e.defineComponent({__name:"list",setup(n){const{mescrollInit:i,downCallback:u,getMescroll:l}=o.useMescroll(e.onPageScroll,e.onReachBottom);let c=e.ref([]),d=e.ref(!1),m=e.ref(!1),p=e.ref(1),f=e.ref([]);e.onLoad((e=>{p.value=e.status||1,v()}));const h=e=>{d.value=!1;let r={page:e.num,limit:e.size,store_id:a.currStoreId(),status:p.value};s.getBarberOrderList(r).then((r=>{let t=r.data.data;1==e.num&&(c.value=[]),c.value=c.value.concat(t),e.endSuccess(t.length),d.value=!0})).catch((()=>{d.value=!0,e.endErr()}))},v=()=>{m.value=!1,t.getOrderStatus().then((e=>{Object.values(e.data).forEach(((e,r)=>{f.value.push(e)})),m.value=!0})).catch((()=>{m.value=!0}))},g=e=>{r.redirect({url:"/addon/zzhc/pages/merchant/barber/order/detail",param:{order_id:e.order_id}})},_=(r,t="")=>{var o;"cancel"==t?(o=r,e.index.showModal({title:"提示",content:"您确定要取消该订单吗？",success:e=>{if(e.confirm){let e={order_id:o.order_id,store_id:a.currStoreId()};s.barberOrderCancel(e).then((e=>{l().resetUpScroll()}))}}})):"service"==t?(e=>{let r={order_id:e.order_id,store_id:a.currStoreId()};s.barberOrderService(r).then((e=>{l().resetUpScroll()}))})(r):"revert"==t?(r=>{e.index.showModal({title:"提示",content:"您确定将该订单退回排队吗？",success:e=>{if(e.confirm){let e={order_id:r.order_id,store_id:a.currStoreId()};s.barberOrderRevert(e).then((e=>{l().resetUpScroll()}))}}})})(r):"finish"==t&&(r=>{e.index.showModal({title:"提示",content:"您确定已完成服务吗？",success:e=>{if(e.confirm){let e={order_id:r.order_id,store_id:a.currStoreId()};s.barberOrderFinish(e).then((e=>{l().resetUpScroll()}))}}})})(r)};return(t,s)=>e.e({a:e.unref(m)},e.unref(m)?{b:e.f(e.unref(f),((r,t,s)=>({a:e.t(r.name),b:e.n({"class-select":e.unref(p)==r.status}),c:e.o((e=>{return t=r.status,p.value=t,c.value=[],void l().resetUpScroll();var t}))})))}:{},{c:e.f(e.unref(c),((t,s,o)=>e.e({a:1==t.status},1==t.status?{b:e.t(t.wait_people),c:e.t(t.wait_duration),d:e.t(t.mobile.substr(t.mobile.length-4))}:{},{e:e.unref(r.img)(t.goods_image),f:e.t(t.goods_name),g:e.t(t.goods_money),h:e.t(t.goods_vip_money),i:"134e9952-1-"+o+",134e9952-0",j:e.p({src:e.unref(r.img)(t.member.headimg),size:"32",leftIcon:"none","default-url":e.unref(r.img)("static/resource/images/default_headimg.png")}),k:e.t(t.member.nickname),l:"134e9952-2-"+o+",134e9952-0",m:e.o((r=>e.unref(a.callPhone)(t.member.phone))),n:e.o((e=>g(t))),o:e.t(t.create_time),p:e.t(t.status_name.name),q:e.o((e=>g(t))),r:1==t.status},1==t.status?{s:e.o((e=>_(t,"cancel")))}:{},{t:1==t.status},1==t.status?{v:e.o((e=>_(t,"service")))}:{},{w:2==t.status},2==t.status?{x:e.o((e=>_(t,"revert")))}:{},{y:2==t.status},2==t.status?{z:e.o((e=>_(t,"finish")))}:{},{A:s}))),d:e.p({name:"phone-fill",color:"var(--primary-color)",size:"28"}),e:!e.unref(c).length&&e.unref(d)},!e.unref(c).length&&e.unref(d)?{f:e.p({option:{icon:e.unref(r.img)("static/resource/images/empty.png")}})}:{},{g:e.sr("mescrollRef","134e9952-0"),h:e.o(e.unref(i)),i:e.o(e.unref(u)),j:e.o(h),k:e.p({top:"114rpx"}),l:e.s(t.themeColor())})}});u.__runtimeHooks=1,tt.createPage(u);
