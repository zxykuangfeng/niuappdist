"use strict";const e=require("../../../../common/vendor.js"),t=require("../../../../utils/common.js"),a=require("../../../../locale/index.js"),l=require("../../../stores/diy.js");if(require("../../../../utils/pages.js"),require("../../../../stores/member.js"),require("../../../api/member.js"),require("../../../../utils/request.js"),require("../../../api/auth.js"),require("../../../../stores/config.js"),require("../../../../stores/system.js"),require("../../../api/system.js"),require("../../../../locale/i18n.js"),require("../../../../locale/language.js"),require("../../../../hooks/useLogin.js"),!Array){e.resolveComponent("u-datetime-picker")()}Math;const u=e.defineComponent({__name:"index",props:["component","index","global"],setup(u,{expose:r}){const d=u,n=l.useDiyStore(),o=e.ref(!1),f=e.ref(!1),i=e.ref(!1),v=e.ref(null),s=e.computed((()=>"decorate"==n.mode?n.value[d.index]:d.component)),m=e.computed((()=>d.global)),p=()=>{let e=[];if(s.value.autofill){let t={title:"已自动填充"};e.push(t)}return e.forEach(((e,t,a)=>{if(t!=a.length-1){let e={title:"|"};a.push(e)}})),e},c=e.computed((()=>{let e="",t="";return s.value.field.value.start.date?(e=s.value.field.value.start.date,t=s.value.field.value.start.date):s.value.start.defaultControl?"current"==s.value.start.timeWay?(e=w(),t=w()):"diy"==s.value.start.timeWay&&(e=s.value.field.default.start.date,t=s.value.field.default.start.date):(e=s.value.start.placeholder,t=""),s.value.field.value.start.date=t,s.value.field.value.start.timestamp=t?B(t):0,e})),g=e.computed((()=>{let e="",t="";if(s.value.field.value.end.date)e=s.value.field.value.end.date,t=s.value.field.value.end.date;else if(s.value.end.defaultControl)if("current"==s.value.end.timeWay){let a=new Date,l=new Date(a.getTime()+6e5);e=w(l),t=w(l)}else"diy"==s.value.end.timeWay&&(e=s.value.field.default.end.date,t=s.value.field.default.end.date);else e=s.value.end.placeholder,t="";return s.value.field.value.end.date=t,s.value.field.value.end.timestamp=t?B(t):0,e})),x=e.computed((()=>{var e="";return e+="position:relative;",s.value.componentStartBgColor&&s.value.componentEndBgColor?e+=`background:linear-gradient(${s.value.componentGradientAngle},${s.value.componentStartBgColor},${s.value.componentEndBgColor});`:s.value.componentStartBgColor?e+="background-color:"+s.value.componentStartBgColor+";":s.value.componentEndBgColor&&(e+="background-color:"+s.value.componentEndBgColor+";"),s.value.componentBgUrl&&(e+=`background-image:url('${t.img(s.value.componentBgUrl)}');`,e+="background-size: cover;background-repeat: no-repeat;"),s.value.topRounded&&(e+="border-top-left-radius:"+2*s.value.topRounded+"rpx;"),s.value.topRounded&&(e+="border-top-right-radius:"+2*s.value.topRounded+"rpx;"),s.value.bottomRounded&&(e+="border-bottom-left-radius:"+2*s.value.bottomRounded+"rpx;"),s.value.bottomRounded&&(e+="border-bottom-right-radius:"+2*s.value.bottomRounded+"rpx;"),e}));e.onMounted((()=>{y(),"decorate"==n.mode&&e.watch((()=>s.value),((e,t)=>{e&&e.componentName}))}));const y=()=>{},C=()=>{"decorate"!==n.mode&&(i.value=!0)},b=e=>{s.value.field.value.start.date=e.value,s.value.field.value.start.timestamp=B(e.value);let t=e.value,a=new Date(`1970-01-01T${e.value}:00`);a.setMinutes(a.getMinutes()+10),t=w(a),s.value.field.value.end.date=t,s.value.field.value.end.timestamp=B(t),o.value=!1},h=e=>{s.value.field.value.end.date=e.value,s.value.field.value.end.timestamp=B(e.value),f.value=!1},q=e=>{j.value||(j.value=s.value.field.value.end.date),s.value.field.value.end.date=e.value},k=()=>{j.value&&(s.value.field.value.end.date=j.value),j.value="",f.value=!1},S=e.computed((()=>{let e=s.value.field.value.start.date.split(":");return Number(e[0]?e[0]:"0")}));let j=e.ref("");const z=e.computed({get:()=>{let e=s.value.field.value.start.date.split(":"),t=s.value.field.value.end.date.split(":"),a=e[0]==t[0]?e[1]:0;return Number(a||"0")},set:e=>{}}),w=(e="")=>{let t=e?new Date(e):new Date;return`${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`},B=e=>{let t=e.split(":"),a=0;return t[0]&&(a+=60*t[0]*60),t[1]&&(a+=60*t[1]),t[2]&&(a+=t[2]),a};return r({verify:()=>{const e={code:!0,message:""};return s.value.field.required&&""==s.value.field.value.start.date?(e.code=!1,e.message=`请选择${s.value.start.placeholder}`):s.value.field.required&&""==s.value.field.value.end.date?(e.code=!1,e.message=`请选择${s.value.end.placeholder}`):s.value.field.value.start.timestamp>=s.value.field.value.end.timestamp&&s.value.field.value.start.timestamp&&s.value.field.value.end.timestamp&&(e.code=!1,e.message="开始时间不能大于等于结束时间"),v.value=e,e},reset:()=>{s.value.field.value.start.date="",s.value.field.value.start.timestamp=0,s.value.field.value.end.date="",s.value.field.value.end.timestamp=0}}),(t,l)=>e.e({a:e.unref(s).viewFormDetail},e.unref(s).viewFormDetail?e.e({b:"style-1"==e.unref(m).completeLayout},"style-1"==e.unref(m).completeLayout?e.e({c:e.unref(s).field.value.start.date||e.unref(s).field.value.end.date},e.unref(s).field.value.start.date||e.unref(s).field.value.end.date?e.e({d:e.t(e.unref(s).field.name),e:e.t(e.unref(s).field.value.start.date),f:e.unref(s).field.value.start.date&&e.unref(s).field.value.end.date},(e.unref(s).field.value.start.date&&e.unref(s).field.value.end.date,{}),{g:e.t(e.unref(s).field.value.end.date)}):{}):{},{h:"style-2"==e.unref(m).completeLayout},"style-2"==e.unref(m).completeLayout?e.e({i:e.unref(s).field.value.start.date||e.unref(s).field.value.end.date},e.unref(s).field.value.start.date||e.unref(s).field.value.end.date?e.e({j:e.t(e.unref(s).field.name),k:e.t(e.unref(s).field.value.start.date),l:e.unref(s).field.value.start.date&&e.unref(s).field.value.end.date},(e.unref(s).field.value.start.date&&e.unref(s).field.value.end.date,{}),{m:e.t(e.unref(s).field.value.end.date)}):{}):{}):e.e({n:"style-1"==e.unref(m).completeLayout},"style-1"==e.unref(m).completeLayout?e.e({o:e.t(e.unref(s).field.name),p:e.unref(s).textColor,q:2*e.unref(s).fontSize+"rpx",r:e.unref(s).fontWeight,s:e.t(e.unref(s).field.required?"*":""),t:"decorate"==e.unref(n).mode&&e.unref(s).isHidden},"decorate"==e.unref(n).mode&&e.unref(s).isHidden?{v:e.t(e.unref(a.t)("diyForm.hidden"))}:{},{w:e.unref(s).field.remark.text},e.unref(s).field.remark.text?{x:e.t(e.unref(s).field.remark.text),y:e.unref(s).field.remark.color,z:2*e.unref(s).field.remark.fontSize+"rpx"}:{},{A:v.value&&!v.value.code},v.value&&!v.value.code?{B:e.t(v.value.message)}:{},{C:e.t(e.unref(c)),D:e.unref(s).defaultControl||e.unref(s).field.value.start.date?"":1,E:e.unref(s).textColor,F:2*e.unref(s).fontSize+"rpx",G:e.o((e=>o.value=!0)),H:e.unref(s).textColor,I:2*e.unref(s).fontSize+"rpx",J:e.t(e.unref(g)),K:e.unref(s).defaultControl||e.unref(s).field.value.end.date?"":1,L:e.unref(s).textColor,M:2*e.unref(s).fontSize+"rpx",N:e.o((e=>f.value=!0)),O:p().length},p().length?{P:e.f(p(),((t,a,l)=>({a:e.t(t.title),b:a,c:e.o((e=>{t.type}))})))}:{}):{},{Q:"style-2"==e.unref(m).completeLayout},"style-2"==e.unref(m).completeLayout?e.e({R:"decorate"==e.unref(n).mode&&e.unref(s).isHidden},"decorate"==e.unref(n).mode&&e.unref(s).isHidden?{S:e.t(e.unref(a.t)("diyForm.hidden"))}:{},{T:e.unref(s).field.required},e.unref(s).field.required?{U:e.t(e.unref(s).field.required?"*":"")}:{},{V:e.t(e.unref(s).field.name),W:e.unref(s).textColor,X:2*e.unref(s).fontSize+"rpx",Y:e.unref(s).fontWeight,Z:"left"==e.unref(m).completeAlign?1:"",aa:"right"==e.unref(m).completeAlign?1:"",ab:e.t(e.unref(c)),ac:e.unref(s).field.value.start.date||e.unref(s).defaultControl?"":1,ad:e.unref(s).textColor,ae:2*e.unref(s).fontSize+"rpx",af:e.o((e=>o.value=!0)),ag:e.unref(s).textColor,ah:2*e.unref(s).fontSize+"rpx",ai:e.t(e.unref(g)),aj:e.unref(s).field.value.end.date||e.unref(s).defaultControl?"":1,ak:e.unref(s).textColor,al:2*e.unref(s).fontSize+"rpx",am:e.o((e=>f.value=!0)),an:e.o(C),ao:e.unref(m).borderControl?"":1,ap:v.value&&!v.value.code},v.value&&!v.value.code?{aq:e.t(v.value.message)}:{},{ar:e.unref(s).field.remark.text},e.unref(s).field.remark.text?{as:e.t(e.unref(s).field.remark.text),at:e.unref(s).field.remark.color,av:2*e.unref(s).field.remark.fontSize+"rpx"}:{},{aw:p().length},p().length?{ax:e.f(p(),((t,a,l)=>({a:e.t(t.title),b:a,c:e.o((e=>{t.type}))})))}:{}):{},{ay:e.o((e=>o.value=!1)),az:e.o(b),aA:e.o((e=>o.value=!1)),aB:e.o((t=>e.unref(s).field.value.start.date=t)),aC:e.p({show:o.value,mode:"time",closeOnClickOverlay:"true",modelValue:e.unref(s).field.value.start.date}),aD:e.o(k),aE:e.o(h),aF:e.o(q),aG:e.o((e=>o.value=!1)),aH:e.o((t=>e.unref(s).field.value.end.date=t)),aI:e.p({show:f.value,minHour:e.unref(S),minMinute:e.unref(z),mode:"time",closeOnClickOverlay:"true",modelValue:e.unref(s).field.value.end.date}),aJ:"decorate"==e.unref(n).mode},(e.unref(n).mode,{}),{aK:e.s(e.unref(x))}))}}),r=e._export_sfc(u,[["__scopeId","data-v-38eafa44"]]);tt.createComponent(r);
