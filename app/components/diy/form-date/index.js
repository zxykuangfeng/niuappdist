"use strict";const e=require("../../../../common/vendor.js"),t=require("../../../../utils/common.js"),r=require("../../../../locale/index.js"),a=require("../../../stores/diy.js");if(require("../../../../utils/pages.js"),require("../../../../stores/member.js"),require("../../../api/member.js"),require("../../../../utils/request.js"),require("../../../api/auth.js"),require("../../../../stores/config.js"),require("../../../../stores/system.js"),require("../../../api/system.js"),require("../../../../locale/i18n.js"),require("../../../../locale/language.js"),require("../../../../hooks/useLogin.js"),!Array){(e.resolveComponent("u-calendar")+e.resolveComponent("u-datetime-picker"))()}Math||((()=>"../../../../node-modules/uview-plus/components/u-calendar/u-calendar.js")+(()=>"../../../../node-modules/uview-plus/components/u-datetime-picker/u-datetime-picker.js"))();const l=e.defineComponent({__name:"index",props:["component","index","global"],setup(l,{expose:u}){const o=l;let n=new Date;n.setFullYear(n.getFullYear()+1);const d=e.ref(n.getTime());let i=new Date;const f=e.ref(i.getTime()),m=a.useDiyStore(),s=e.ref(!1),v=e.ref(!1),c=e.ref(null),p=e.computed((()=>"decorate"==m.mode?m.value[o.index]:o.component)),g=e.computed((()=>o.global)),y=()=>{let e=[];if(p.value.autofill){let t={title:"已自动填充"};e.push(t)}return e.forEach(((e,t,r)=>{if(t!=r.length-1){let e={title:"|"};r.push(e)}})),e},x=e.computed((()=>{var e="";if(p.value.field.value.date){let r=p.value.field.value.timestamp;e=q(r),p.value.field.value.date=e,p.value.field.value.timestamp=t.timeTurnTimeStamp(e)}else if(p.value.defaultControl){if("current"==p.value.dateWay)e=q();else if("diy"==p.value.dateWay){let t=p.value.field.default.timestamp||"";e=q(t)}p.value.field.value.date=e,p.value.field.value.timestamp=t.timeTurnTimeStamp(e)}else e=p.value.placeholder;return e})),h=e.computed((()=>{var e="";return e+="position:relative;",p.value.componentStartBgColor&&p.value.componentEndBgColor?e+=`background:linear-gradient(${p.value.componentGradientAngle},${p.value.componentStartBgColor},${p.value.componentEndBgColor});`:p.value.componentStartBgColor?e+="background-color:"+p.value.componentStartBgColor+";":p.value.componentEndBgColor&&(e+="background-color:"+p.value.componentEndBgColor+";"),p.value.componentBgUrl&&(e+=`background-image:url('${t.img(p.value.componentBgUrl)}');`,e+="background-size: cover;background-repeat: no-repeat;"),p.value.topRounded&&(e+="border-top-left-radius:"+2*p.value.topRounded+"rpx;"),p.value.topRounded&&(e+="border-top-right-radius:"+2*p.value.topRounded+"rpx;"),p.value.bottomRounded&&(e+="border-bottom-left-radius:"+2*p.value.bottomRounded+"rpx;"),p.value.bottomRounded&&(e+="border-bottom-right-radius:"+2*p.value.bottomRounded+"rpx;"),e}));e.onMounted((()=>{b(),"decorate"==m.mode&&e.watch((()=>p.value),((e,t)=>{e&&e.componentName}))}));const b=()=>{},S=()=>{"decorate"!==m.mode&&("YYYY-MM-DD HH:mm"==p.value.dateFormat?v.value=!0:s.value=!0)},k=e=>{p.value.field.value.date=e[0],p.value.field.value.timestamp=t.timeTurnTimeStamp(e[0]),s.value=!1},Y=e=>{p.value.field.value.date=e.value,p.value.field.value.timestamp=t.timeTurnTimeStamp(e.value),v.value=!1},C=e=>(t.timeStampTurnTime(Date.parse(e.date)/1e3,"year_month_day"),e),q=(e="",t=p.value.dateFormat)=>{let r=e?new Date(1e3*e):new Date,a=r.getFullYear(),l=String(r.getMonth()+1).padStart(2,"0"),u=String(r.getDate()).padStart(2,"0");const o=String(r.getHours()).padStart(2,"0"),n=String(r.getMinutes()).padStart(2,"0");let d="";return"YYYY年M月D日"==t?d=`${a}年${l}月${u}日`:"YYYY-MM-DD"==t?d=`${a}-${l}-${u}`:"YYYY/MM/DD"==t?d=`${a}/${l}/${u}`:"YYYY-MM-DD HH:mm"==t&&(d=`${a}-${l}-${u} ${o}:${n}`),d};return u({verify:()=>{const e={code:!0,message:""};return!p.value.field.required||p.value.field.value&&p.value.field.value.timestamp||(e.code=!1,e.message=`请选择${p.value.placeholder}`),c.value=e,e},reset:()=>{p.value.field.value.date="",p.value.field.value.timestamp=""}}),(t,a)=>e.e({a:e.unref(p).viewFormDetail},e.unref(p).viewFormDetail?e.e({b:"style-1"==e.unref(g).completeLayout},"style-1"==e.unref(g).completeLayout?{c:e.t(e.unref(p).field.name),d:e.t(e.unref(p).field.value.date)}:{},{e:"style-2"==e.unref(g).completeLayout},"style-2"==e.unref(g).completeLayout?{f:e.t(e.unref(p).field.name),g:e.t(e.unref(p).field.value.date)}:{}):e.e({h:"style-1"==e.unref(g).completeLayout},"style-1"==e.unref(g).completeLayout?e.e({i:e.t(e.unref(p).field.name),j:e.unref(p).textColor,k:2*e.unref(p).fontSize+"rpx",l:e.unref(p).fontWeight,m:e.t(e.unref(p).field.required?"*":""),n:"decorate"==e.unref(m).mode&&e.unref(p).isHidden},"decorate"==e.unref(m).mode&&e.unref(p).isHidden?{o:e.t(e.unref(r.t)("diyForm.hidden"))}:{},{p:e.unref(p).field.remark.text},e.unref(p).field.remark.text?{q:e.t(e.unref(p).field.remark.text),r:e.unref(p).field.remark.color,s:2*e.unref(p).field.remark.fontSize+"rpx"}:{},{t:c.value&&!c.value.code},c.value&&!c.value.code?{v:e.t(c.value.message)}:{},{w:e.t(e.unref(x)),x:e.unref(p).field.value.date||e.unref(p).defaultControl?"":1,y:e.unref(p).textColor,z:2*e.unref(p).fontSize+"rpx",A:e.o(S),B:y().length},y().length?{C:e.f(y(),((t,r,a)=>({a:e.t(t.title),b:r,c:e.o((e=>{t.type}))})))}:{}):{},{D:"style-2"==e.unref(g).completeLayout},"style-2"==e.unref(g).completeLayout?e.e({E:"decorate"==e.unref(m).mode&&e.unref(p).isHidden},"decorate"==e.unref(m).mode&&e.unref(p).isHidden?{F:e.t(e.unref(r.t)("diyForm.hidden"))}:{},{G:e.unref(p).field.required},e.unref(p).field.required?{H:e.t(e.unref(p).field.required?"*":"")}:{},{I:e.t(e.unref(p).field.name),J:e.unref(p).textColor,K:2*e.unref(p).fontSize+"rpx",L:e.unref(p).fontWeight,M:"left"==e.unref(g).completeAlign?1:"",N:"right"==e.unref(g).completeAlign?1:"",O:e.t(e.unref(x)),P:e.unref(p).field.value.date||e.unref(p).defaultControl?"":1,Q:e.unref(p).textColor,R:2*e.unref(p).fontSize+"rpx",S:e.o(S),T:e.unref(g).borderControl?"":1,U:c.value&&!c.value.code},c.value&&!c.value.code?{V:e.t(c.value.message)}:{},{W:e.unref(p).field.remark.text},e.unref(p).field.remark.text?{X:e.t(e.unref(p).field.remark.text),Y:e.unref(p).field.remark.color,Z:2*e.unref(p).field.remark.fontSize+"rpx"}:{},{aa:y().length},y().length?{ab:e.f(y(),((t,r,a)=>({a:e.t(t.title),b:r,c:e.o((e=>{t.type}))})))}:{}):{},{ac:e.sr("calendar","5f0ceda7-0"),ad:e.o(k),ae:e.o((e=>s.value=!1)),af:e.p({show:s.value,mode:"single",closeOnClickOverlay:"true",formatter:C,confirmDisabledText:"禁止选择",color:"var(--primary-color)",maxDate:d.value}),ag:e.o((e=>v.value=!1)),ah:e.o(Y),ai:e.o((e=>v.value=!1)),aj:e.o((t=>e.unref(p).field.value.date=t)),ak:e.p({show:v.value,mode:"datetime",closeOnClickOverlay:"true",minDate:f.value,modelValue:e.unref(p).field.value.date}),al:"decorate"==e.unref(m).mode},(e.unref(m).mode,{}),{am:e.s(e.unref(h))}))}}),u=e._export_sfc(l,[["__scopeId","data-v-5f0ceda7"]]);tt.createComponent(u);
