"use strict";const e=require("../../../../common/vendor.js"),r=require("../../../../utils/common.js"),t=require("../../../../locale/index.js"),o=require("../../../stores/diy.js");require("../../../../utils/pages.js"),require("../../../../stores/member.js"),require("../../../api/member.js"),require("../../../../utils/request.js"),require("../../../api/auth.js"),require("../../../../stores/config.js"),require("../../../../stores/system.js"),require("../../../api/system.js"),require("../../../../locale/i18n.js"),require("../../../../locale/language.js"),require("../../../../hooks/useLogin.js"),Math||(n+u)();const u=()=>"../form-privacy-pop/index.js",n=()=>"../form-identity-privacy/index.js",l=e.defineComponent({__name:"index",props:["component","index","global"],setup(u,{expose:n}){const l=u,a=o.useDiyStore(),d=e.ref(null),i=e.ref(null),f=e.ref(null),c=e.computed((()=>"decorate"==a.mode?a.value[l.index]:l.component)),m=e.computed((()=>l.global)),s=e.computed((()=>{const e=String(c.value.field.value);return c.value.field.privacyProtection?e.replace(/(\d{3})\d*(\d{4})/,"$1****$2"):e})),p=e.computed((()=>{let e="";return e+=c.value.placeholder,e})),v=e.computed((()=>`${c.value.field.name}已开启隐私保护，提交后会部分打码，只有你自己和管理员才能查看完整信息`)),g=()=>{let e=[];if(c.value.autofill){let r={title:"已自动填充"};e.push(r)}if(c.value.field.privacyProtection){let r={title:"已开启隐私保护",type:"privacy"};e.push(r)}return e.forEach(((e,r,t)=>{if(r!=t.length-1){let e={title:"|"};t.push(e)}})),e},y=e=>{"privacy"==e&&i.value.open()},x=()=>{e.nextTick$1((()=>{f.value?f.value.open():console.warn("formDetailPrivacyRef is not defined")}))},b=e.computed((()=>{var e="";return e+="position:relative;",c.value.componentStartBgColor&&c.value.componentEndBgColor?e+=`background:linear-gradient(${c.value.componentGradientAngle},${c.value.componentStartBgColor},${c.value.componentEndBgColor});`:c.value.componentStartBgColor?e+="background-color:"+c.value.componentStartBgColor+";":c.value.componentEndBgColor&&(e+="background-color:"+c.value.componentEndBgColor+";"),c.value.componentBgUrl&&(e+=`background-image:url('${r.img(c.value.componentBgUrl)}');`,e+="background-size: cover;background-repeat: no-repeat;"),c.value.topRounded&&(e+="border-top-left-radius:"+2*c.value.topRounded+"rpx;"),c.value.topRounded&&(e+="border-top-right-radius:"+2*c.value.topRounded+"rpx;"),c.value.bottomRounded&&(e+="border-bottom-left-radius:"+2*c.value.bottomRounded+"rpx;"),c.value.bottomRounded&&(e+="border-bottom-right-radius:"+2*c.value.bottomRounded+"rpx;"),e}));e.onMounted((()=>{h(),"decorate"==a.mode&&e.watch((()=>c.value),((e,r)=>{e&&"FormIdentity"==e.componentName&&h()}))}));const h=()=>{("decorate"==a.mode||""==c.value.field.value&&c.value.field.default)&&(c.value.field.value=c.value.field.default)},q=e.computed((()=>"decorate"==a.mode));return n({verify:()=>{const e={code:!0,message:""};return c.value.field.required&&""==c.value.field.value&&"decorate"!=a.mode?(e.code=!1,e.message=`${p.value}`):/^[1-9]\d{5}(18|19|20)\d{2}((0[1-9])|(1[0-2]))((0[1-9])|([1-2][0-9])|(3[0-1]))\d{3}[0-9Xx]$/.test(c.value.field.value)||"decorate"==a.mode||(e.code=!1,e.message="身份证格式不正确，请重新输入"),d.value=e,e},reset:()=>{c.value.field.value=""}}),(r,o)=>e.e({a:e.unref(c).viewFormDetail},e.unref(c).viewFormDetail?e.e({b:"style-1"==e.unref(m).completeLayout},"style-1"==e.unref(m).completeLayout?e.e({c:e.t(e.unref(c).field.name),d:e.t(e.unref(s)),e:e.unref(c).field.privacyProtection},e.unref(c).field.privacyProtection?{f:e.t(e.unref(t.t)("diyForm.view")),g:e.o(x)}:{}):{},{h:"style-2"==e.unref(m).completeLayout},"style-2"==e.unref(m).completeLayout?e.e({i:e.t(e.unref(c).field.name),j:e.t(e.unref(s)),k:e.unref(c).field.privacyProtection},e.unref(c).field.privacyProtection?{l:e.t(e.unref(t.t)("diyForm.view")),m:e.o(x)}:{}):{},{n:e.sr(f,"3d76d97c-0",{k:"formDetailPrivacyRef"}),o:e.p({data:e.unref(c).field.value})}):e.e({p:"style-1"==e.unref(m).completeLayout},"style-1"==e.unref(m).completeLayout?e.e({q:e.t(e.unref(c).field.name),r:e.unref(c).textColor,s:2*e.unref(c).fontSize+"rpx",t:e.unref(c).fontWeight,v:e.t(e.unref(c).field.required?"*":""),w:"decorate"==e.unref(a).mode&&e.unref(c).isHidden},"decorate"==e.unref(a).mode&&e.unref(c).isHidden?{x:e.t(e.unref(t.t)("diyForm.hidden"))}:{},{y:e.unref(c).field.remark.text},e.unref(c).field.remark.text?{z:e.t(e.unref(c).field.remark.text),A:e.unref(c).field.remark.color,B:2*e.unref(c).field.remark.fontSize+"rpx"}:{},{C:d.value&&!d.value.code},d.value&&!d.value.code?{D:e.t(d.value.message)}:{},{E:e.unref(p),F:{"font-size":2*e.unref(c).fontSize+"rpx"},G:e.unref(c).textColor,H:2*e.unref(c).fontSize+"rpx",I:e.unref(q),J:e.unref(c).field.value,K:e.o((r=>e.unref(c).field.value=r.detail.value)),L:g().length},g().length?{M:e.f(g(),((r,t,o)=>({a:e.t(r.title),b:t,c:e.o((e=>y(r.type)))})))}:{}):{},{N:"style-2"==e.unref(m).completeLayout},"style-2"==e.unref(m).completeLayout?e.e({O:"decorate"==e.unref(a).mode&&e.unref(c).isHidden},"decorate"==e.unref(a).mode&&e.unref(c).isHidden?{P:e.t(e.unref(t.t)("diyForm.hidden"))}:{},{Q:e.unref(c).field.required},e.unref(c).field.required?{R:e.t(e.unref(c).field.required?"*":"")}:{},{S:e.t(e.unref(c).field.name),T:e.unref(c).textColor,U:2*e.unref(c).fontSize+"rpx",V:e.unref(c).fontWeight,W:"left"==e.unref(m).completeAlign?1:"",X:"right"==e.unref(m).completeAlign?1:"",Y:e.unref(p),Z:{"font-size":2*e.unref(c).fontSize+"rpx"},aa:e.unref(c).textColor,ab:2*e.unref(c).fontSize+"rpx",ac:e.unref(q),ad:e.unref(c).field.value,ae:e.o((r=>e.unref(c).field.value=r.detail.value)),af:e.unref(m).borderControl?"":1,ag:d.value&&!d.value.code},d.value&&!d.value.code?{ah:e.t(d.value.message)}:{},{ai:e.unref(c).field.remark.text},e.unref(c).field.remark.text?{aj:e.t(e.unref(c).field.remark.text),ak:e.unref(c).field.remark.color,al:2*e.unref(c).field.remark.fontSize+"rpx"}:{},{am:g().length},g().length?{an:e.f(g(),((r,t,o)=>({a:e.t(r.title),b:t,c:e.o((e=>y(r.type)))})))}:{}):{},{ao:"decorate"==e.unref(a).mode},(e.unref(a).mode,{}),{ap:e.sr(i,"3d76d97c-1",{k:"formPrivacyRef"}),aq:e.p({data:e.unref(v)}),ar:e.s(e.unref(b))}))}}),a=e._export_sfc(l,[["__scopeId","data-v-3d76d97c"]]);tt.createComponent(a);
