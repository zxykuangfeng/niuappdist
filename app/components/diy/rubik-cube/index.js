"use strict";const e=require("../../../../common/vendor.js"),t=require("../../../stores/diy.js"),r=require("../../../../utils/common.js");require("../../../../hooks/useLogin.js"),require("../../../../utils/request.js"),require("../../../../stores/member.js"),require("../../../api/member.js"),require("../../../api/auth.js"),require("../../../../stores/config.js"),require("../../../../stores/system.js"),require("../../../api/system.js"),require("../../../../locale/index.js"),require("../../../../locale/i18n.js"),require("../../../../locale/language.js"),require("../../../../utils/pages.js");const i=e.defineComponent({__name:"index",props:["component","index"],setup(i){const o=i,a=t.useDiyStore(),d=e.computed((()=>"decorate"==a.mode?a.value[o.index]:o.component)),u=t=>e.index.upx2px(t)+1,g=e.computed((()=>{var e="";return e+="position:relative;",d.value.componentStartBgColor&&(d.value.componentStartBgColor&&d.value.componentEndBgColor?e+=`background:linear-gradient(${d.value.componentGradientAngle},${d.value.componentStartBgColor},${d.value.componentEndBgColor});`:e+="background-color:"+d.value.componentStartBgColor+";"),d.value.componentBgUrl&&(e+=`background-image:url('${r.img(d.value.componentBgUrl)}');`,e+="background-size: cover;background-repeat: no-repeat;"),d.value.topRounded&&(e+="border-top-left-radius:"+2*d.value.topRounded+"rpx;"),d.value.topRounded&&(e+="border-top-right-radius:"+2*d.value.topRounded+"rpx;"),d.value.bottomRounded&&(e+="border-bottom-left-radius:"+2*d.value.bottomRounded+"rpx;"),d.value.bottomRounded&&(e+="border-bottom-right-radius:"+2*d.value.bottomRounded+"rpx;"),e})),m=e.computed((()=>{var e="";return d.value.componentBgUrl&&(e+="position:absolute;top:0;width:100%;",e+=`background: rgba(0,0,0,${d.value.componentBgAlpha/10});`,e+=`height:${n.value}px;`,d.value.topRounded&&(e+="border-top-left-radius:"+2*d.value.topRounded+"rpx;"),d.value.topRounded&&(e+="border-top-right-radius:"+2*d.value.topRounded+"rpx;"),d.value.bottomRounded&&(e+="border-bottom-left-radius:"+2*d.value.bottomRounded+"rpx;"),d.value.bottomRounded&&(e+="border-bottom-right-radius:"+2*d.value.bottomRounded+"rpx;")),e}));e.onMounted((()=>{s(),"decorate"==a.mode?e.watch((()=>d.value),((e,t)=>{e&&"RubikCube"==e.componentName&&s()})):e.watch((()=>d.value),((e,t)=>{s()}))}));const l=e.getCurrentInstance(),n=e.ref(0),s=()=>{"decorate"==a.mode&&d.value.list.forEach((e=>{""==e.imageUrl&&(e.imgWidth=690,e.imgHeight=330)})),h(),e.nextTick$1((()=>{e.index.createSelectorQuery().in(l).select(".rubik-cube").boundingClientRect((e=>{n.value=e.height})).exec()}))},h=()=>{var e={"row1-of2":{ratio:2,width:"calc((100% - "+u(2*d.value.imageGap)+"px) / 2)"},"row1-of3":{ratio:3,width:"calc((100% - "+u(4*d.value.imageGap)+"px) / 3)"},"row1-of4":{ratio:4,width:"calc((100% - "+u(6*d.value.imageGap)+"px) / 4)"}};d.value.list.forEach(((e,t)=>{e.pageItemStyle=((e,t)=>{var r="";return"right"==d.value.elementAngle||{"row1-lt-of2-rt":[["border-top-right-radius","border-bottom-right-radius"],["border-top-left-radius","border-bottom-left-radius","border-bottom-right-radius"],["border-top-left-radius","border-bottom-left-radius","border-top-right-radius"]],"row1-lt-of1-tp-of2-bm":[["border-top-right-radius","border-bottom-right-radius"],["border-top-left-radius","border-bottom-left-radius","border-bottom-right-radius"],["border-radius"],["border-top-left-radius","border-bottom-left-radius","border-top-right-radius"]],"row1-tp-of2-bm":[["border-bottom-left-radius","border-bottom-right-radius"],["border-top-left-radius","border-bottom-right-radius","border-top-right-radius"],["border-top-left-radius","border-bottom-left-radius","border-top-right-radius"]],"row2-lt-of2-rt":[["border-top-right-radius","border-bottom-left-radius","border-bottom-right-radius"],["border-top-left-radius","border-bottom-right-radius","border-bottom-left-radius"],["border-top-left-radius","border-bottom-right-radius","border-top-right-radius"],["border-top-left-radius","border-bottom-left-radius","border-top-right-radius"]],"row1-of4":[["border-top-right-radius","border-bottom-right-radius"],["border-radius"],["border-radius"],["border-top-left-radius","border-bottom-left-radius"]],"row1-of3":[["border-top-right-radius","border-bottom-right-radius"],["border-radius"],["border-top-left-radius","border-bottom-left-radius"]],"row1-of2":[["border-top-right-radius","border-bottom-right-radius"],["border-top-left-radius","border-bottom-left-radius"]]}[e][t].forEach(((e,t)=>{r+="border-top-left-radius:"+2*d.value.topElementRounded+"rpx;",r+="border-top-right-radius:"+2*d.value.topElementRounded+"rpx;",r+="border-bottom-left-radius:"+2*d.value.bottomElementRounded+"rpx;",r+="border-bottom-right-radius:"+2*d.value.bottomElementRounded+"rpx;"})),r})(d.value.mode,t)})),e[d.value.mode]?p(e[d.value.mode]):"row2-lt-of2-rt"==d.value.mode?f():"row1-lt-of2-rt"==d.value.mode?b():"row1-tp-of2-bm"==d.value.mode?c():"row1-lt-of1-tp-of2-bm"==d.value.mode&&v()},p=t=>{e.index.getSystemInfo({success:e=>{let r=0;d.value.list.forEach(((i,o)=>{var a=i.imgHeight/i.imgWidth;let g=e.windowWidth-u(2*d.value.margin.both);d.value.imageGap>0&&(g-=u(t.ratio*d.value.imageGap*2)),i.imgWidth=g/t.ratio,i.imgHeight=i.imgWidth*a,(0==r||r<i.imgHeight)&&(r=i.imgHeight)})),d.value.list.forEach(((e,i)=>{e.widthStyle=t.width,e.imgHeight=r}))}})},f=()=>{e.index.getSystemInfo({success:e=>{let t=0,r=0;d.value.list.forEach(((i,o)=>{var a=i.imgHeight/i.imgWidth;i.imgWidth=e.windowWidth,i.imgWidth-=u(4*d.value.margin.both),d.value.imageGap>0&&(i.imgWidth-=u(2*d.value.imageGap)),i.imgWidth=i.imgWidth/2,i.imgHeight=i.imgWidth*a,o<=1?(0==t||t<i.imgHeight)&&(t=i.imgHeight):o>1&&(0==r||r<i.imgHeight)&&(r=i.imgHeight)})),d.value.list.forEach(((e,i)=>{e.imgWidth="calc((100% - "+u(2*d.value.imageGap)+"px) / 2)",e.widthStyle=e.imgWidth,i<=1?e.imgHeight=t:i>1&&(e.imgHeight=r)}))}})},b=()=>{let t=0;d.value.list[1].imgWidth,d.value.list[2].imgWidth,e.index.getSystemInfo({success:e=>{d.value.list.forEach(((r,i)=>{if(0==i){var o=r.imgHeight/r.imgWidth;r.imgWidth=e.windowWidth-u(4*d.value.margin.both)-u(2*d.value.imageGap),r.imgWidth=r.imgWidth/2,r.imgHeight=r.imgWidth*o,t=(r.imgHeight-u(2*d.value.imageGap))/2,r.imgWidth+="px"}else r.imgWidth=d.value.list[0].imgWidth,r.imgHeight=t}))}})},c=()=>{var t=0;e.index.getSystemInfo({success:e=>{d.value.list.forEach(((r,i)=>{var o=r.imgHeight/r.imgWidth;0==i?r.imgWidth=e.windowWidth-u(4*d.value.margin.both):i>0&&(r.imgWidth=e.windowWidth-u(4*d.value.margin.both)-u(2*d.value.imageGap),r.imgWidth=r.imgWidth/2),r.imgHeight=r.imgWidth*o,i>0&&(0==t||t<r.imgHeight)&&(t=r.imgHeight)})),d.value.list.forEach(((e,r)=>{e.imgWidth+="px",e.widthStyle=e.imgWidth,r>0&&(e.imgHeight=t)}))}})},v=()=>{e.index.getSystemInfo({success:e=>{d.value.list.forEach(((t,r)=>{if(0==r){var i=t.imgHeight/t.imgWidth;t.imgWidth=e.windowWidth-u(4*d.value.margin.both)-u(2*d.value.imageGap),t.imgWidth=t.imgWidth/2,t.imgHeight=t.imgWidth*i}else 1==r?(t.imgWidth=d.value.list[0].imgWidth,t.imgHeight=(d.value.list[0].imgHeight-u(2*d.value.imageGap))/2):r>1&&(t.imgWidth=(d.value.list[0].imgWidth-u(2*d.value.imageGap))/2,t.imgHeight=d.value.list[1].imgHeight)})),d.value.list.forEach(((e,t)=>{e.imgWidth+="px"}))}})};return(t,i)=>e.e({a:e.s(e.unref(m)),b:"row1-lt-of2-rt"==e.unref(d).mode},"row1-lt-of2-rt"==e.unref(d).mode?e.e({c:e.unref(d).list[0].imageUrl},e.unref(d).list[0].imageUrl?{d:e.unref(r.img)(e.unref(d).list[0].imageUrl),e:e.s(e.unref(d).list[0].pageItemStyle)}:{f:e.unref(r.img)("static/resource/images/diy/figure.png"),g:e.s(e.unref(d).list[0].pageItemStyle)},{h:e.o((t=>e.unref(a).toRedirect(e.unref(d).list[0].link))),i:e.n(e.unref(d).mode),j:2*e.unref(d).imageGap+"rpx",k:e.unref(d).list[0].imgWidth,l:e.unref(d).list[0].imgHeight+"px",m:e.f(e.unref(d).list,((t,i,o)=>e.e({a:i>0},i>0?e.e({b:t.imageUrl},t.imageUrl?{c:e.unref(r.img)(t.imageUrl),d:e.s(t.pageItemStyle)}:{e:e.unref(r.img)("static/resource/images/diy/figure.png"),f:e.s(t.pageItemStyle)},{g:e.o((r=>e.unref(a).toRedirect(t.link))),h:e.n(e.unref(d).mode),i:2*e.unref(d).imageGap+"rpx",j:t.imgWidth,k:t.imgHeight+"px"}):{},{l:i})))}):"row1-lt-of1-tp-of2-bm"==e.unref(d).mode?e.e({o:e.unref(d).list[0].imageUrl},e.unref(d).list[0].imageUrl?{p:e.unref(r.img)(e.unref(d).list[0].imageUrl),q:e.s(e.unref(d).list[0].pageItemStyle)}:{r:e.unref(r.img)("static/resource/images/diy/figure.png"),s:e.s(e.unref(d).list[0].pageItemStyle)},{t:e.o((t=>e.unref(a).toRedirect(e.unref(d).list[0].link))),v:e.n(e.unref(d).mode),w:2*e.unref(d).imageGap+"rpx",x:e.unref(d).list[0].imgWidth,y:e.unref(d).list[0].imgHeight+"px",z:e.unref(d).list[1].imageUrl},e.unref(d).list[1].imageUrl?{A:e.unref(r.img)(e.unref(d).list[1].imageUrl),B:e.s(e.unref(d).list[1].pageItemStyle)}:{C:e.unref(r.img)("static/resource/images/diy/figure.png"),D:e.s(e.unref(d).list[1].pageItemStyle)},{E:e.o((t=>e.unref(a).toRedirect(e.unref(d).list[1].link))),F:e.n(e.unref(d).mode),G:2*e.unref(d).imageGap+"rpx",H:e.unref(d).list[1].imgWidth,I:e.unref(d).list[1].imgHeight+"px",J:e.f(e.unref(d).list,((t,i,o)=>e.e({a:i>1},i>1?e.e({b:t.imageUrl},t.imageUrl?{c:e.unref(r.img)(t.imageUrl),d:e.s(t.pageItemStyle)}:{e:e.unref(r.img)("static/resource/images/diy/figure.png"),f:e.s(t.pageItemStyle)},{g:e.o((r=>e.unref(a).toRedirect(t.link))),h:e.n(e.unref(d).mode),i:2*e.unref(d).imageGap+"rpx",j:t.imgWidth,k:t.imgHeight+"px"}):{},{l:i})))}):{K:e.f(e.unref(d).list,((t,i,o)=>e.e({a:t.imageUrl},t.imageUrl?{b:e.unref(r.img)(t.imageUrl),c:e.s(t.pageItemStyle)}:{d:e.unref(r.img)("static/resource/images/diy/figure.png"),e:e.s(t.pageItemStyle)},{f:i,g:e.o((r=>e.unref(a).toRedirect(t.link))),h:t.widthStyle,i:t.imgHeight+"px"}))),L:e.n(e.unref(d).mode),M:2*e.unref(d).imageGap+"rpx",N:2*e.unref(d).imageGap+"rpx"},{n:"row1-lt-of1-tp-of2-bm"==e.unref(d).mode,O:e.n(e.unref(a).mode),P:e.s(e.unref(g))})}});tt.createComponent(i);
