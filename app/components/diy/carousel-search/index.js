"use strict";const e=require("../../../../common/vendor.js"),r=require("../../../../utils/common.js"),o=require("../../../stores/diy.js"),t=require("../../../api/diy.js"),a=require("../../../../hooks/useLocation.js"),l=require("../../../../stores/system.js");if(require("../../../../utils/pages.js"),require("../../../../stores/member.js"),require("../../../api/member.js"),require("../../../../utils/request.js"),require("../../../../locale/index.js"),require("../../../../locale/i18n.js"),require("../../../../locale/language.js"),require("../../../api/auth.js"),require("../../../../stores/config.js"),require("../../../../hooks/useLogin.js"),require("../../../api/system.js"),!Array){e.resolveComponent("u-popup")()}Math||((()=>"../../../../node-modules/uview-plus/components/u-popup/u-popup.js")+n)();const n=()=>"../../../../addon/components/diy/group/index.js",u=e.defineComponent({__name:"index",props:["component","index","global","scrollBool"],setup(n){const u=n,i=l.useSystemStore();e.index.getSystemInfoSync();const s=e.getCurrentInstance(),d=o.useDiyStore(),p=e.computed((()=>"decorate"==d.mode?d.value[u.index]:u.component));let c=!1;p.value&&"style-2"==p.value.search.style&&"decorate"!=d.mode&&(c=!0);const f=a.useLocation(c);f.onLoad(),f.init();const g=e.computed((()=>{var e="";return p.value.componentStartBgColor&&(p.value.componentStartBgColor&&p.value.componentEndBgColor?e+=`background:linear-gradient(${p.value.componentGradientAngle},${p.value.componentStartBgColor},${p.value.componentEndBgColor});`:e+="background-color:"+p.value.componentStartBgColor+";"),p.value.topRounded&&(e+="border-top-left-radius:"+2*p.value.topRounded+"rpx;"),p.value.topRounded&&(e+="border-top-right-radius:"+2*p.value.topRounded+"rpx;"),p.value.bottomRounded&&(e+="border-bottom-left-radius:"+2*p.value.bottomRounded+"rpx;"),p.value.bottomRounded&&(e+="border-bottom-right-radius:"+2*p.value.bottomRounded+"rpx;"),e})),v=e.ref(""),m=e.ref(!1),h=e.computed((()=>{var r="";if("style-3"==p.value.swiper.swiperStyle&&(r+="position: absolute;z-index: 99;left: 0;right: 0;"),"decorate"==d.mode)return r;if("fixed"==p.value.positionWay&&(null!=u.scrollBool&&-1!=u.scrollBool&&(r+="position: fixed;z-index: 99;top: 0;left: 0;right: 0;"),A=e.index.getMenuButtonBoundingClientRect(),u.global.topStatusBar.isShow&&(r+="top:"+d.topTabarHeight+"px;"),1==u.scrollBool||u.scrollBool,m.value=!1,1==u.scrollBool)){let e=(p.value.fixedBgColor||"").split(","),o=p.value.fixedBgColor?parseInt(e[e.length-1]):0;p.value.fixedBgColor&&0!=o?(m.value=!1,r+="background-color:"+p.value.fixedBgColor+";"):m.value=!0}return r})),b=e=>{let r="";return e?(r=p.value.tab.selectColor,"fixed"==p.value.positionWay&&1==u.scrollBool&&(r=p.value.tab.fixedSelectColor)):(r=p.value.tab.noColor,"fixed"==p.value.positionWay&&1==u.scrollBool&&(r=p.value.tab.fixedNoColor)),r},y=e.computed((()=>{let e=!0;for(let r=0;r<p.value.search.hotWord.list.length;r++){if(p.value.search.hotWord.list[r].text){e=!1;break}}return e})),x=e.computed((()=>{var e="";let r=u.global.pageStartBgColor?u.global.pageStartBgColor:"rgba(255,255,255,1)";if(r.indexOf("(")>-1){let o=r.split("(")[1].split(")")[0].split(",");1==p.value.bgGradient&&(e+=`background: linear-gradient(rgba(${o[0]}, ${o[1]}, ${o[2]}, 0) 65%, rgba(${o[0]}, ${o[1]}, ${o[2]}, 0.6) 70%, rgba(${o[0]}, ${o[1]}, ${o[2]}, 0.85) 80%, rgba(${o[0]}, ${o[1]}, ${o[2]}, 0.95) 90%,  rgb(${o[0]}, ${o[1]}, ${o[2]}, 1) 100%);`)}else e+=`background: (${r});`;return e})),w=e.computed((()=>"style-2"==p.value.swiper.swiperStyle||"style-3"==p.value.swiper.swiperStyle)),S=e.computed((()=>2*p.value.swiper.imageHeight+"rpx")),C=e.ref(0),B=e=>{C.value=e.detail.current},R=e.computed((()=>{var e="";return p.value.swiper.topRounded&&(e+="border-top-left-radius:"+2*p.value.swiper.topRounded+"rpx;"),p.value.swiper.topRounded&&(e+="border-top-right-radius:"+2*p.value.swiper.topRounded+"rpx;"),p.value.swiper.bottomRounded&&(e+="border-bottom-left-radius:"+2*p.value.swiper.bottomRounded+"rpx;"),p.value.swiper.bottomRounded&&(e+="border-bottom-right-radius:"+2*p.value.swiper.bottomRounded+"rpx;"),e})),$=e.computed((()=>{var e="";return p.value.search.subTitle.textColor&&(e+="color:"+p.value.search.subTitle.textColor+";"),p.value.search.subTitle.startColor&&p.value.search.subTitle.endColor?e+=`background:linear-gradient(${p.value.search.subTitle.startColor}, ${p.value.search.subTitle.endColor});`:e+="background-color:"+(p.value.search.subTitle.startColor||p.value.search.subTitle.endColor)+";",e})),j=e.ref(-1),k=e.ref(""),q=(e,r)=>{if("decorate"==d.mode)return!1;k.value=e.source,j.value=r,"home"==e.source?d.topFixedStatus="home":"diy_page"==e.source&&(d.topFixedStatus="diy",_(e.diy_id))},T=e.ref(!1);let A={};const I=e.ref("");A=e.index.getMenuButtonBoundingClientRect(),I.value+="padding-top:"+A.top+"px;",e.onMounted((()=>{if(W(),"decorate"==d.mode&&e.watch((()=>p.value),((e,r)=>{e&&"CarouselSearch"==e.componentName&&W()})),"fixed"==p.value.positionWay)if(0==u.global.topStatusBar.isShow){I.value="";let e=A.width?2*A.width+"rpx":"70rpx";I.value+="padding-right:calc("+e+" + 30rpx);",I.value+="padding-top:"+A.top+"px;"}else u.global.topStatusBar&&(I.value="");else{let e=A.width?2*A.width+"rpx":"70rpx";I.value+="padding-right:calc("+e+" + 30rpx);"}}));const W=()=>{e.nextTick$1((()=>{setTimeout((()=>{"style-3"!=p.value.swiper.swiperStyle?e.index.createSelectorQuery().in(s).select(".fixed-wrap").boundingClientRect((e=>{v.value=(e.height||0)+"px"})).exec():v.value=""}))})),f.refresh(),q({source:"home"},-1),p.value.swiper.list.forEach((e=>{""==e.imageUrl&&(e.imgWidth=690,e.imgHeight=330)}))},U=e.reactive({pageMode:"diy",title:"",global:{},value:[]}),_=r=>{if(!r)return U.pageMode="diy",U.title="",U.global={},void(U.value=[]);t.getDiyInfo({id:r}).then((r=>{if(r.data.value){let o=r.data;U.pageMode=o.mode,U.title=o.title;let t=JSON.parse(o.value);U.global=t.global,U.global.topStatusBar.isShow=!1,U.global.bottomTabBarSwitch=!1,U.value=t.value,U.value.forEach(((e,r)=>{e.pageStyle="",e.pageStartBgColor&&(e.pageStartBgColor&&e.pageEndBgColor?e.pageStyle+=`background:linear-gradient(${e.pageGradientAngle},${e.pageStartBgColor},${e.pageEndBgColor});`:e.pageStyle+="background-color:"+e.pageStartBgColor+";"),e.margin&&(e.margin.top>0&&(e.pageStyle+="padding-top:"+2*e.margin.top+"rpx;"),e.pageStyle+="padding-bottom:"+2*e.margin.bottom+"rpx;",e.pageStyle+="padding-right:"+2*e.margin.both+"rpx;",e.pageStyle+="padding-left:"+2*e.margin.both+"rpx;")})),e.index.setNavigationBarTitle({title:U.title})}}))};let G=e.ref(!0),M=e.index.getStorageSync("componentsScrollValGroup");if(M&&"object"==typeof M)M.CarouselSearch=20,e.index.setStorageSync("componentsScrollValGroup",M);else{let r={CarouselSearch:20};e.index.setStorageSync("componentsScrollValGroup",r)}return(o,t)=>e.e({a:e.unref(p).swiper.control&&e.unref(p).swiper.list&&e.unref(p).swiper.list[C.value].imageUrl},e.unref(p).swiper.control&&e.unref(p).swiper.list&&e.unref(p).swiper.list[C.value].imageUrl?{b:e.unref(r.img)(e.unref(p).swiper.list[C.value].imageUrl)}:{},{c:e.s(e.unref(x)),d:1==e.unref(p).bgGradient?1:"",e:"style-1"==e.unref(p).search.style},"style-1"==e.unref(p).search.style?e.e({f:e.unref(p).search.logo},e.unref(p).search.logo?{g:e.unref(r.img)(e.unref(p).search.logo)}:{},{h:e.t(e.unref(y)?e.unref(p).search.text:""),i:e.unref(p).search.color,j:e.unref(p).search.btnBgColor,k:e.unref(p).search.btnColor,l:!e.unref(y)},e.unref(y)?{}:{m:e.f(e.unref(p).search.hotWord.list,((r,o,t)=>({a:e.t(r.text),b:r.id}))),n:e.unref(p).search.color,o:1e3*e.unref(p).search.hotWord.interval},{p:e.unref(p).search.bgColor,q:e.o((r=>e.unref(d).toRedirect(e.unref(p).search.link))),r:e.o((r=>e.unref(d).toRedirect(e.unref(p).search.link))),s:e.s(I.value)}):{},{t:"style-2"==e.unref(p).search.style},"style-2"==e.unref(p).search.style?e.e({v:e.unref(p).search.logo},e.unref(p).search.logo?{w:e.unref(r.img)(e.unref(p).search.logo)}:{},{x:e.unref(p).search.subTitle.text},e.unref(p).search.subTitle.text?{y:e.t(e.unref(p).search.subTitle.text),z:e.s(e.unref($))}:{},{A:e.s(I.value),B:e.unref(i).diyAddressInfo},e.unref(i).diyAddressInfo?e.e({C:e.t(e.unref(i).diyAddressInfo.city),D:e.unref(i).diyAddressInfo.community},e.unref(i).diyAddressInfo.community?{E:e.t(e.unref(i).diyAddressInfo.community)}:{},{F:e.o((r=>e.unref(f).reposition())),G:e.unref(p).search.positionColor}):{H:e.t(e.unref(i).defaultPositionAddress),I:e.o((r=>e.unref(f).reposition())),J:e.unref(p).search.positionColor},{K:e.t(e.unref(y)?e.unref(p).search.text:""),L:e.unref(p).search.color,M:e.unref(p).search.btnBgColor,N:e.unref(p).search.btnColor,O:!e.unref(y)},e.unref(y)?{}:{P:e.f(e.unref(p).search.hotWord.list,((r,o,t)=>({a:e.t(r.text),b:r.id}))),Q:e.unref(p).search.color,R:1e3*e.unref(p).search.hotWord.interval},{S:e.unref(p).search.bgColor,T:e.o((r=>e.unref(d).toRedirect(e.unref(p).search.link))),U:e.o((r=>e.unref(d).toRedirect(e.unref(p).search.link)))}):{},{V:e.unref(p).tab.control},e.unref(p).tab.control?e.e({W:b(-1==j.value),X:e.o((e=>q({source:"home"},-1))),Y:e.n({active:-1==j.value}),Z:e.f(e.unref(p).tab.list,((r,o,t)=>({a:e.t(r.text),b:b(o==j.value),c:e.n({active:o==j.value}),d:e.o((e=>q(r,o))),e:"a"+o,f:o}))),aa:"a"+j.value,ab:e.unref(p).tab.list.length},e.unref(p).tab.list.length?{ac:e.o((e=>T.value=!0))}:{}):{},{ad:m.value},m.value?e.e({ae:e.unref(p).swiper.control&&e.unref(p).swiper.list&&e.unref(p).swiper.list[C.value].imageUrl},e.unref(p).swiper.control&&e.unref(p).swiper.list&&e.unref(p).swiper.list[C.value].imageUrl?{af:e.unref(r.img)(e.unref(p).swiper.list[C.value].imageUrl)}:{}):{},{ag:e.s(e.unref(h)),ah:"decorate"!=e.unref(d).mode},"decorate"!=e.unref(d).mode?e.e({ai:"fixed"==e.unref(p).positionWay&&null!=u.scrollBool&&-1!=u.scrollBool},"fixed"==e.unref(p).positionWay&&null!=u.scrollBool&&-1!=u.scrollBool?{aj:v.value}:{}):{},{ak:e.unref(p).swiper.control},e.unref(p).swiper.control?{al:e.f(e.unref(p).swiper.list,((o,t,a)=>e.e({a:o.imageUrl},o.imageUrl?{b:e.unref(r.img)(o.imageUrl),c:e.s(e.unref(R)),d:e.n({"swiper-animation":C.value!=t&&"style-3"!=e.unref(p).swiper.indicatorStyle})}:{e:e.unref(r.img)("static/resource/images/diy/figure.png"),f:e.s(e.unref(R)),g:e.n({"swiper-animation":C.value!=t&&"style-3"!=e.unref(p).swiper.indicatorStyle})},{h:e.o((r=>e.unref(d).toRedirect(o.link))),i:o.id}))),am:e.unref(S),an:e.s(e.unref(R)),ao:e.unref(S),ap:e.o(B),aq:"left"==e.unref(p).swiper.indicatorAlign?1:"",ar:"right"==e.unref(p).swiper.indicatorAlign?1:"",as:"style-2"==e.unref(p).swiper.indicatorStyle?1:"",at:"style-3"==e.unref(p).swiper.indicatorStyle?1:"",av:e.unref(w)?0:"26rpx",aw:e.unref(w)?0:"26rpx",ax:1e3*e.unref(p).swiper.interval,ay:e.unref(G),az:e.unref(p).swiper.indicatorColor,aA:e.unref(p).swiper.indicatorActiveColor}:{},{aB:e.unref(w)&&"style-3"!=e.unref(p).swiper.swiperStyle?1:"",aC:"style-3"==e.unref(p).swiper.swiperStyle?1:"",aD:e.s((p.value.swiper.swiperStyle,"")),aE:e.unref(A).top+"px",aF:e.o((e=>q({source:"home"},-1))),aG:e.n({"tab-select-popup":-1==j.value}),aH:e.f(e.unref(p).tab.list,((r,o,t)=>({a:e.t(r.text),b:e.o((e=>q(r,o))),c:o,d:e.n({"tab-select-popup":o==j.value})}))),aI:e.o((e=>T.value=!1)),aJ:e.p({safeAreaInsetTop:!0,show:T.value,mode:"top"}),aK:"diy_page"==k.value},"diy_page"==k.value?{aL:e.p({data:U})}:{},{aM:e.s(e.unref(g))})}}),i=e._export_sfc(u,[["__scopeId","data-v-b47b7a1b"]]);tt.createComponent(i);
