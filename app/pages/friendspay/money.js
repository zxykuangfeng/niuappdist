"use strict";const e=require("../../../common/vendor.js"),a=require("../../../locale/index.js"),t=require("../../../utils/common.js"),i=require("../../../utils/topTabbar.js"),u=require("../../api/friendspay.js"),l=require("../../../hooks/useLogin.js");if(require("../../../locale/i18n.js"),require("../../../locale/language.js"),require("../../../utils/pages.js"),require("../../../stores/system.js"),require("../../api/system.js"),require("../../../utils/request.js"),require("../../../stores/member.js"),require("../../api/member.js"),require("../../api/auth.js"),require("../../../stores/config.js"),require("../../stores/diy.js"),!Array){(e.resolveComponent("u-avatar")+e.resolveComponent("u--image")+e.resolveComponent("pay")+e.resolveComponent("loading-page"))()}Math||((()=>"../../../node-modules/uview-plus/components/u-avatar/u-avatar.js")+(()=>"../../../node-modules/uview-plus/components/u--image/u--image.js")+n+(()=>"../../../components/pay/pay.js")+(()=>"../../../components/loading-page/loading-page.js"))();const n=()=>"./components/message.js",s=e.defineComponent({__name:"money",setup(n){const s=i.topTabar();s.setTopTabbarParam({title:""});const o=e.ref(!0),r=e.ref(0),p=e.ref(""),m=e.ref({}),v=e.ref(!1),c=e.ref(!0),g=e.ref(null);e.onLoad((e=>{r.value=e.id||0,p.value=e.type||""})),e.onShow((()=>{r.value&&p.value&&d(p.value,r.value)})),e.onHide((()=>{g.value&&(clearTimeout(g.value),g.value=null)})),e.onUnload((()=>{g.value&&(clearTimeout(g.value),g.value=null)}));const d=(a,i)=>{c.value&&(o.value=!0,c.value=!1),u.getFriendspayInfo(a,i).then((t=>{m.value=t.data,e.index.setNavigationBarTitle({title:m.value.config.pay_page_name}),s.setTopTabbarParam({title:m.value.config.pay_page_name}),o.value=!1,2!=m.value.status&&1!=m.value.status&&-1!=m.value.status?g.value=setTimeout((()=>{d(a,i)}),3e3):(clearTimeout(g.value),g.value=null)})).catch((()=>{g.value&&(clearTimeout(g.value),g.value=null),o.value=!1;t.goback({title:"未找到帮付订单信息",url:"/app/pages/index/index",mode:"reLaunch"})}))},f=e.ref(null),_=()=>{f.value.open(m.value.config)},y=e.ref(),h=()=>{var e;t.getToken()?null==(e=y.value)||e.open(m.value.trade_type,m.value.trade_id,"/app/pages/index/index","friendspay"):l.useLogin().setLoginBack({url:"/app/pages/friendspay/money",param:{id:m.value.trade_id,type:m.value.trade_type}})};return(i,u)=>e.e({a:Object.keys(m.value).length&&!o.value},Object.keys(m.value).length&&!o.value?e.e({b:e.p({src:e.unref(t.img)(m.value.member.headimg),size:"50",leftIcon:"none","default-url":e.unref(t.img)("static/resource/images/default_headimg.png")}),c:e.t(m.value.member.nickname),d:m.value.config.pay_leave_message},m.value.config.pay_leave_message?{e:e.t(m.value.config.pay_leave_message)}:{},{f:"url("+e.unref(t.img)("static/resource/images/app/friendpay_money.png")+") left bottom / cover no-repeat",g:e.t(e.unref(a.t)("payMoney")),h:e.t(parseFloat(m.value.money).toFixed(2).split(".")[0]),i:e.t(parseFloat(m.value.money).toFixed(2).split(".")[1]),j:2==m.value.status},2==m.value.status?{k:e.t(e.unref(a.t)("finish"))}:-1==m.value.status?{m:e.t(e.unref(a.t)("close"))}:{n:e.t(m.value.config.pay_button_name?m.value.config.pay_button_name:e.unref(a.t)("payGenerously")),o:v.value,p:e.o(h)},{l:-1==m.value.status,q:e.o((a=>e.unref(t.redirect)({url:"/app/pages/index/index"}))),r:m.value.config.pay_info_switch},m.value.config.pay_info_switch?e.e({s:"[]"!==JSON.stringify(m.value.trade_info)&&m.value.trade_info.item_list.length},"[]"!==JSON.stringify(m.value.trade_info)&&m.value.trade_info.item_list.length?e.e({t:e.t(e.unref(a.t)("helpPayInfo")),v:m.value.config.pay_explain_switch},m.value.config.pay_explain_switch?{w:e.t(m.value.config.pay_explain_title),x:e.o(_)}:{},{y:e.f(m.value.trade_info.item_list,((a,i,u)=>e.e({a:"4eac2cda-1-"+u,b:e.p({radius:"var(--goods-rounded-big)",width:"170rpx",height:"170rpx",src:e.unref(t.img)(a.item_image?a.item_image:""),model:"aspectFill"}),c:e.t(a.item_name),d:a.item_sub_name},a.item_sub_name?{e:e.t(a.item_sub_name)}:{},{f:e.t(parseFloat(a.item_price).toFixed(2).split(".")[0]),g:e.t(parseFloat(a.item_price).toFixed(2).split(".")[1]),h:e.t(a.item_num),i:i+1!=m.value.trade_info.length?1:""}))),z:e.unref(t.img)("static/resource/images/diy/shop_default.jpg"),A:e.t(m.value.trade_info.item_total)}):{B:e.t(m.value.body)}):{}):{},{C:e.sr(f,"4eac2cda-2",{k:"messageRef"}),D:e.sr(y,"4eac2cda-3",{k:"payRef"}),E:e.p({loading:o.value}),F:e.s(i.themeColor())})}});s.__runtimeHooks=1;const o=e._export_sfc(s,[["__scopeId","data-v-4eac2cda"]]);tt.createPage(o);
