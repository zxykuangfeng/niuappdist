"use strict";const e=require("../../../common/vendor.js"),a=require("../../api/member.js"),t=require("../../../locale/index.js"),o=require("../../api/system.js"),n=require("../../../utils/common.js");if(require("../../../utils/request.js"),require("../../../stores/member.js"),require("../../api/auth.js"),require("../../../stores/config.js"),require("../../stores/diy.js"),require("../../../hooks/useLogin.js"),require("../../../stores/system.js"),require("../../../locale/i18n.js"),require("../../../locale/language.js"),require("../../../utils/pages.js"),!Array){(e.resolveComponent("u-input")+e.resolveComponent("u-form-item")+e.resolveComponent("u-form")+e.resolveComponent("u-upload")+e.resolveComponent("u-modal"))()}Math||((()=>"../../../node-modules/uview-plus/components/u-input/u-input.js")+(()=>"../../../node-modules/uview-plus/components/u-form-item/u-form-item.js")+(()=>"../../../node-modules/uview-plus/components/u-form/u-form.js")+(()=>"../../../node-modules/uview-plus/components/u-upload/u-upload.js")+(()=>"../../../node-modules/uview-plus/components/u-modal/u-modal.js"))();const r=e.defineComponent({__name:"account_edit",setup(r){const l=e.ref(!1),c=e.ref(null),u=e.ref("get"),p=e.ref(!1),d=e.reactive({account_id:0,account_type:"bank",bank_name:"",realname:"",account_no:"",transfer_payment_code:""}),m=e.computed((()=>({realname:{type:"string",required:!0,message:"bank"==d.account_type?t.t("bankRealnamePlaceholder"):t.t("alipayRealnamePlaceholder"),trigger:["blur","change"]},bank_name:{type:"string",required:"bank"==d.account_type,message:t.t("bankNamePlaceholder"),trigger:["blur","change"]},transfer_payment_code:{validator(e,a,o){if(a&&a.length)o();else{let e="alipay"==d.account_type?t.t("alipayAccountImgPlaceholder"):t.t("wechatCodeAccountImgPlaceholder");o(new Error(e))}}}})));e.onLoad((o=>{o.type&&(d.account_type=o.type),o.mode&&(u.value=o.mode),o.id&&(d.account_id=o.id||"",d.account_id?e.index.setNavigationBarTitle({title:t.t("editAccountTitle")}):e.index.setNavigationBarTitle({title:t.t("addAccountTitle")}),a.getCashoutAccountInfo({account_id:o.id}).then((e=>{e.data&&Object.keys(d).forEach((a=>{null!=e.data[a]&&(d[a]=e.data[a])}))})))}));const i=()=>{const e=d.account_id?a.editCashoutAccount:a.addCashoutAccount;c.value.validate().then((()=>{l.value||(l.value=!0,e(d).then((e=>{"get"==u.value?n.redirect({url:"/app/pages/member/account",param:{type:d.account_type,mode:u.value}}):n.redirect({url:"/app/pages/member/apply_cash_out",param:{account_id:d.account_id?d.account_id:e.data.id,type:d.account_type},mode:"redirectTo"})})).catch((()=>{l.value=!1})))}))},s=e=>{o.uploadImage({filePath:e.file.url,name:"file"}).then((e=>{e.data&&(d.transfer_payment_code="",d.transfer_payment_code=e.data.url)})).catch((()=>{}))},f=e=>{d.transfer_payment_code=""},_=()=>{a.deleteCashoutAccount(d.account_id).then((()=>{n.redirect({url:"/app/pages/member/account",mode:"redirectTo"})}))},h=a=>{e.index.previewImage({current:0,urls:[a]})};return(a,o)=>e.e({a:"bank"==d.account_type},"bank"==d.account_type?{b:e.t(d.account_id?e.unref(t.t)("editBankCard"):e.unref(t.t)("addBankCard")),c:e.t(d.account_id?e.unref(t.t)("editBankCardTips"):e.unref(t.t)("addBankCardTips")),d:e.o(e.m((e=>d.realname=e),{trim:!0},!0)),e:e.p({fontSize:"28rpx",maxlength:"30",border:"none",clearable:!0,placeholder:e.unref(t.t)("bankRealnamePlaceholder"),modelValue:d.realname}),f:e.p({label:e.unref(t.t)("bankRealname"),prop:"realname",labelWidth:"200rpx"}),g:e.o(e.m((e=>d.bank_name=e),{trim:!0},!0)),h:e.p({fontSize:"28rpx",maxlength:"30",border:"none",clearable:!0,placeholder:e.unref(t.t)("bankNamePlaceholder"),modelValue:d.bank_name}),i:e.p({label:e.unref(t.t)("bankName"),prop:"bank_name",labelWidth:"200rpx"}),j:e.o(e.m((e=>d.account_no=e),{trim:!0},!0)),k:e.p({fontSize:"28rpx",maxlength:"30",border:"none",clearable:!0,placeholder:e.unref(t.t)("bankAccountNoPlaceholder"),modelValue:d.account_no}),l:e.p({label:e.unref(t.t)("bankAccountNo"),prop:"account_no",labelWidth:"200rpx"}),m:e.sr(c,"a52c840c-0",{k:"formRef"}),n:e.p({labelPosition:"left",model:d,errorType:"toast",rules:e.unref(m)})}:{},{o:"alipay"==d.account_type},"alipay"==d.account_type?e.e({p:e.t(d.account_id?e.unref(t.t)("editAlipayAccount"):e.unref(t.t)("addAlipayAccount")),q:e.o(e.m((e=>d.realname=e),{trim:!0},!0)),r:e.p({maxlength:"30",border:"none",fontSize:"28rpx",clearable:!0,placeholder:e.unref(t.t)("alipayRealnamePlaceholder"),modelValue:d.realname}),s:e.p({label:e.unref(t.t)("alipayRealname"),prop:"realname"}),t:e.o(e.m((e=>d.account_no=e),{trim:!0},!0)),v:e.p({border:"none",maxlength:"30",fontSize:"28rpx",clearable:!0,placeholder:e.unref(t.t)("alipayAccountNoPlaceholder"),modelValue:d.account_no}),w:e.p({label:e.unref(t.t)("alipayAccountNo"),prop:"account_no"}),x:d.transfer_payment_code},d.transfer_payment_code?{y:e.unref(n.img)(d.transfer_payment_code),z:e.o((a=>h(e.unref(n.img)(d.transfer_payment_code)))),A:e.o(f)}:{B:e.o(s),C:e.o(f),D:e.p({maxCount:1})},{E:e.p({label:"收款码",prop:"transfer_payment_code"}),F:e.sr(c,"a52c840c-7",{k:"formRef"}),G:e.p({labelPosition:"left",model:d,labelWidth:"200rpx",errorType:"toast",rules:e.unref(m)})}):{},{H:"wechat_code"==d.account_type},"wechat_code"==d.account_type?e.e({I:e.t(d.account_id?e.unref(t.t)("editWechatCodeAccount"):e.unref(t.t)("addWechatCodeAccount")),J:e.o(e.m((e=>d.realname=e),{trim:!0},!0)),K:e.p({maxlength:"30",border:"none",fontSize:"28rpx",clearable:!0,placeholder:e.unref(t.t)("alipayRealnamePlaceholder"),modelValue:d.realname}),L:e.p({label:e.unref(t.t)("alipayRealname"),prop:"realname"}),M:e.o(e.m((e=>d.account_no=e),{trim:!0},!0)),N:e.p({border:"none",maxlength:"30",fontSize:"28rpx",clearable:!0,placeholder:e.unref(t.t)("wechatCodeAccountNoPlaceholder"),modelValue:d.account_no}),O:e.p({label:e.unref(t.t)("wechatCodeAccountNo"),prop:"account_no"}),P:d.transfer_payment_code},d.transfer_payment_code?{Q:e.unref(n.img)(d.transfer_payment_code),R:e.o((a=>h(e.unref(n.img)(d.transfer_payment_code)))),S:e.o(f)}:{T:e.o(s),U:e.o(f),V:e.p({maxCount:1})},{W:e.p({label:"收款码",prop:"transfer_payment_code"}),X:e.sr(c,"a52c840c-14",{k:"formRef"}),Y:e.p({labelPosition:"left",model:d,labelWidth:"200rpx",errorType:"toast",rules:e.unref(m)})}):{},{Z:e.t(e.unref(t.t)("save")),aa:l.value,ab:e.o(i),ac:e.o(_),ad:e.o((e=>p.value=!1)),ae:e.p({show:p.value,content:e.unref(t.t)("deleteConfirm"),confirmText:e.unref(t.t)("confirm"),cancelText:e.unref(t.t)("cancel"),showCancelButton:!0,confirmColor:"var(--primary-color)"}),af:e.s(a.themeColor())})}}),l=e._export_sfc(r,[["__scopeId","data-v-a52c840c"]]);tt.createPage(l);
