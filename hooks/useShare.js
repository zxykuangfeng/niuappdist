"use strict";const e=require("../common/vendor.js"),r=require("../utils/common.js"),t=require("../app/api/diy.js"),a=require("../stores/system.js");exports.useShare=()=>{var s={};return{wechatInit:()=>{r.isWeixinBrowser()&&wechat.init()},setShare:(a={})=>{""!=r.currRoute()&&-1==r.currRoute().indexOf("app/pages/index/close")&&-1==r.currRoute().indexOf("app/pages/index/nosite")&&((()=>{let t=r.currShareRoute().params,a=e.index.getStorageSync("wap_member_id");a&&(t.mid=a);let s=[];for(let e in t)s.push(e+"="+t[e])})(),a&&Object.keys(a).length?(a.wechat,a.weapp):t.getShareInfo({route:"/"+r.currRoute(),params:JSON.stringify(r.currShareRoute().params)}).then((r=>{r.data,e.index.setStorageSync("weappOptions",s)})))},onShareAppMessage:(r={})=>e.onShareAppMessage((()=>{let t=e.index.getStorageSync("weappOptions");return t||(t={}),a.useSystemStore().shareCallback&&a.useSystemStore().shareCallback(),{...t,...r}})),onShareTimeline:(r={})=>e.onShareTimeline((()=>{let t=e.index.getStorageSync("weappOptions");return t||(t={}),a.useSystemStore().shareCallback&&a.useSystemStore().shareCallback(),{...t,...r}}))}};
