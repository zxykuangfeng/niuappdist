"use strict";const e=require("../common/vendor.js"),r=require("./common.js"),t=require("./interceptor.js"),s=require("../stores/config.js"),i=require("../stores/system.js"),o=require("../hooks/useShare.js"),a={install(a){a.mixin({data:()=>({query:{},hasRedirected:!1,lastPath:"",lastQuery:""}),onLoad:e=>{const t=r.currRoute()||"";this.query=e,i.useSystemStore().$patch((e=>{e.currRoute=t}))},onShow:()=>{const s=r.currRoute()||"";i.useSystemStore().$patch((e=>{e.currRoute=s}));let o=e.index.getStorageSync("loginBack");o&&o.url=="/"+s&&(this.query=o.param),this.hasRedirected&&this.lastPath===s&&JSON.stringify(this.lastQuery)===JSON.stringify(this.query)||(t.redirectInterceptor({path:s,query:this.query}),this.hasRedirected=!0,this.lastPath=s,this.lastQuery={...this.query})},onShareAppMessage:()=>o.useShare().onShareAppMessage(),onShareTimeline:()=>o.useShare().onShareTimeline(),methods:{themeColor:()=>s.useConfigStore().getThemeColor()}})}};exports.mixin=a;
