"use strict";const e=require("../../../common/vendor.js"),o=require("../mescroll-uni/mescroll-uni.js"),t=require("../mescroll-uni/mescroll-uni-option.js"),s=require("../mescroll-uni/mescroll-i18n.js"),r=require("../mescroll-uni/wxs/mixins.js");require("../../../utils/common.js"),require("../../../utils/pages.js"),require("../../../app/stores/diy.js"),require("../../../hooks/useLogin.js"),require("../../../utils/request.js"),require("../../../stores/member.js"),require("../../../app/api/member.js"),require("../../../app/api/auth.js"),require("../../../stores/config.js"),require("../../../stores/system.js"),require("../../../app/api/system.js"),require("../../../locale/index.js"),require("../../../locale/i18n.js"),require("../../../locale/language.js");const n={name:"mescroll-body",mixins:[r.WxsMixin],components:{MescrollTop:()=>"../mescroll-uni/components/mescroll-top.js"},props:{down:Object,up:Object,i18n:Object,top:[String,Number],topbar:[Boolean,String],bottom:[String,Number],safearea:Boolean,height:[String,Number],bottombar:{type:Boolean,default:!0},sticky:Boolean},data:()=>({mescroll:{optDown:{},optUp:{}},downHight:0,downRate:0,downLoadType:0,upLoadType:0,isShowEmpty:!1,isShowToTop:!1,windowHeight:0,windowBottom:0,statusBarHeight:0}),computed:{minHeight(){return this.toPx(this.height||"100%")+"px"},numTop(){return this.toPx(this.top)},padTop(){return this.numTop+"px"},numBottom(){return this.toPx(this.bottom)},padBottom(){return this.numBottom+"px"},isDownReset(){return 3===this.downLoadType||4===this.downLoadType},transition(){return this.isDownReset?"transform 300ms":""},translateY(){return this.downHight>0?"translateY("+this.downHight+"px)":""},isDownLoading(){return 3===this.downLoadType},downRotate(){return"rotate("+360*this.downRate+"deg)"},downText(){if(!this.mescroll)return"";switch(this.downLoadType){case 1:default:return this.mescroll.optDown.textInOffset;case 2:return this.mescroll.optDown.textOutOffset;case 3:return this.mescroll.optDown.textLoading;case 4:return this.mescroll.isDownEndSuccess?this.mescroll.optDown.textSuccess:0==this.mescroll.isDownEndSuccess?this.mescroll.optDown.textErr:this.mescroll.optDown.textInOffset}}},methods:{toPx(o){if("string"==typeof o)if(-1!==o.indexOf("px"))if(-1!==o.indexOf("rpx"))o=o.replace("rpx","");else{if(-1===o.indexOf("upx"))return Number(o.replace("px",""));o=o.replace("upx","")}else if(-1!==o.indexOf("%")){let e=Number(o.replace("%",""))/100;return this.windowHeight*e}return o?e.index.upx2px(Number(o)):0},emptyClick(){this.$emit("emptyclick",this.mescroll)},toTopClick(){this.mescroll.scrollTo(0,this.mescroll.optUp.toTop.duration),this.$emit("topclick",this.mescroll)}},created(){let r=this,n={down:{inOffset(){r.downLoadType=1},outOffset(){r.downLoadType=2},onMoving(e,o,t){r.downHight=t,r.downRate=o},showLoading(e,o){r.downLoadType=3,r.downHight=o},beforeEndDownScroll:e=>(r.downLoadType=4,e.optDown.beforeEndDelay),endDownScroll(){r.downLoadType=4,r.downHight=0,r.downResetTimer&&(clearTimeout(r.downResetTimer),r.downResetTimer=null),r.downResetTimer=setTimeout((()=>{4===r.downLoadType&&(r.downLoadType=0)}),300)},callback:function(e){r.$emit("down",e)}},up:{showLoading(){r.upLoadType=1},showNoMore(){r.upLoadType=2},hideUpScroll(e){r.upLoadType=e.optUp.hasNext?0:3},empty:{onShow(e){r.isShowEmpty=e}},toTop:{onShow(e){r.isShowToTop=e}},callback:function(e){r.$emit("up",e)}}},l=s.mescrollI18n.getType(),i={type:l};o.MeScroll.extend(i,r.i18n),o.MeScroll.extend(i,t.GlobalOption.i18n),o.MeScroll.extend(n,i[l]),o.MeScroll.extend(n,{down:t.GlobalOption.down,up:t.GlobalOption.up});let p=JSON.parse(JSON.stringify({down:r.down,up:r.up}));o.MeScroll.extend(p,n),r.mescroll=new o.MeScroll(p,!0),r.mescroll.i18n=i,r.$emit("init",r.mescroll);const c=e.index.getSystemInfoSync();c.windowHeight&&(r.windowHeight=c.windowHeight),c.windowBottom&&(r.windowBottom=c.windowBottom),c.statusBarHeight&&(r.statusBarHeight=c.statusBarHeight),r.mescroll.setBodyHeight(c.windowHeight),r.mescroll.resetScrollTo(((o,t)=>{"string"==typeof o?setTimeout((()=>{let s;s=-1==o.indexOf("#")&&-1==o.indexOf(".")?"#"+o:o,e.index.createSelectorQuery().select(s).boundingClientRect((function(o){if(o){let s=o.top;s+=r.mescroll.getScrollTop(),e.index.pageScrollTo({scrollTop:s,duration:t})}else console.error(s+" does not exist")})).exec()}),30):e.index.pageScrollTo({scrollTop:o,duration:t})})),r.up&&r.up.toTop&&null!=r.up.toTop.safearea||(r.mescroll.optUp.toTop.safearea=r.safearea),e.index.$on("setMescrollGlobalOption",(e=>{if(!e)return;let t=e.i18n?e.i18n.type:null;if(t&&r.mescroll.i18n.type!=t&&(r.mescroll.i18n.type=t,s.mescrollI18n.setType(t),o.MeScroll.extend(e,r.mescroll.i18n[t])),e.down){let t=o.MeScroll.extend({},e.down);r.mescroll.optDown=o.MeScroll.extend(t,r.mescroll.optDown)}if(e.up){let t=o.MeScroll.extend({},e.up);r.mescroll.optUp=o.MeScroll.extend(t,r.mescroll.optUp)}}))},destroyed(){e.index.$off("setMescrollGlobalOption")}};if(!Array){(e.resolveComponent("mescroll-empty")+e.resolveComponent("mescroll-top"))()}const l=e._export_sfc(n,[["render",function(o,t,s,r,n,l){return e.e({a:o.wxsProp},o.wxsProp?e.e({b:s.topbar&&n.statusBarHeight},s.topbar&&n.statusBarHeight?{c:n.statusBarHeight+"px",d:s.topbar}:{},{e:n.mescroll.optDown.use},n.mescroll.optDown.use?{f:l.isDownLoading?1:"",g:n.mescroll.optDown.textColor,h:l.downRotate,i:e.t(l.downText),j:n.mescroll.optDown.bgColor,k:n.mescroll.optDown.textColor}:{},{l:n.isShowEmpty},n.isShowEmpty?{m:e.o(l.emptyClick),n:e.p({option:n.mescroll.optUp.empty})}:{},{o:n.mescroll.optUp.use&&!l.isDownLoading&&3!==n.upLoadType},n.mescroll.optUp.use&&!l.isDownLoading&&3!==n.upLoadType?e.e({p:n.mescroll.optUp.textColor,q:e.t(n.mescroll.optUp.textLoading),r:1===n.upLoadType,s:2===n.upLoadType},2===n.upLoadType?{t:e.t(n.mescroll.optUp.textNoMore)}:{},{v:n.mescroll.optUp.bgColor,w:n.mescroll.optUp.textColor}):{},{x:l.translateY,y:l.transition,z:o.wxsBiz.callObserver,A:o.callProp,B:s.safearea},(s.safearea,{}),{C:e.o(l.toTopClick),D:e.o((e=>n.isShowToTop=e)),E:e.p({option:n.mescroll.optUp.toTop,modelValue:n.isShowToTop}),F:s.sticky?1:"",G:l.minHeight,H:l.padTop,I:l.padBottom,J:e.o(((...e)=>o.wxsBiz.touchstartEvent&&o.wxsBiz.touchstartEvent(...e))),K:e.o(((...e)=>o.wxsBiz.touchmoveEvent&&o.wxsBiz.touchmoveEvent(...e))),L:e.o(((...e)=>o.wxsBiz.touchendEvent&&o.wxsBiz.touchendEvent(...e))),M:e.o(((...e)=>o.wxsBiz.touchendEvent&&o.wxsBiz.touchendEvent(...e))),N:o.wxsBiz.propObserver,O:o.wxsProp}):{})}]]);tt.createComponent(l);
